{"code":"(this.webpackJsonpd3ia=this.webpackJsonpd3ia||[]).push([[21],{240:function(t,e,r){\"use strict\";r.r(e);var n=r(109),i=r(105),a=r.n(i),c=r(122),o=r(46),s=r(11),l=r(24),u=r(205),d=r(230),f=r(241),p=r(224),j=r(204),b=r(231),m=r(199),v=r(117),O=r(206),h=r(80),g=r(201),x=r(115),k=r(2),y=r(236),w=r(141),C=r(21);var E=function(t){t.data;var e=t.statistic,r=t.mapViz,n=t.mapScale,i=Object(y.a)().t,a=Object(k.useRef)(null),c=Object(k.useRef)(null),E=Object(w.a)(),N=Object(o.a)(E,2),T=N[0],R=N[1].width;return Object(k.useEffect)((function(){var t=Object(x.a)().duration(s.c);if(r!==s.p.CHOROPLETH){var e=Object(g.a)(c.current);e.select(\".ramp\").transition(t).attr(\"opacity\",0).attr(\"display\",\"none\").attr(\"xlink:href\",null),e.select(\".bars\").selectAll(\"rect\").transition(t).attr(\"opacity\",0).remove(),e.selectAll(\".axis > *:not(.axistext)\").remove(),e.select(\".axistext\").text(\"\")}if(r!==s.p.BUBBLE){var n=Object(g.a)(a.current);n.select(\".circles\").selectAll(\"circle\").transition(t).attr(\"r\",0).attr(\"cy\",0).remove(),n.selectAll(\".circle-axis > *\").remove()}if(r!==s.p.SPIKES){var i=Object(g.a)(a.current);i.select(\".spikes\").call((function(e){return e.selectAll(\"path\").transition(t).attr(\"d\",Object(l.l)(0)).remove()})).call((function(t){return t.selectAll(\"text\").remove()})).transition(t).selectAll(\"g\").remove(),i.selectAll(\".spike-axis > *\").remove()}}),[r]),Object(k.useEffect)((function(){if(R){var t=s.w[e],x=R/s.j[0];if(r===s.p.BUBBLE){var k=Object(g.a)(a.current),y=n.domain(),w=Object(o.a)(y,2)[1],C=k.select(\".circles\").attr(\"transform\",\"translate(48,40)\").attr(\"text-anchor\",\"middle\"),E=[.1,.4,1].map((function(t){return t*w}));C.selectAll(\"circle\").data(E).join(\"circle\").attr(\"fill\",\"none\").attr(\"stroke\",t.color+\"70\").transition(i).attr(\"cy\",(function(t){return-n(t)})).attr(\"r\",(function(t){return n(t)}));var N=n.copy().range([0,-2*n(w)]);k.select(\".circle-axis\").attr(\"transform\",\"translate(48,50)\").transition(i).call(Object(f.b)(N).tickSize(0).tickPadding(0).tickValues(E).tickFormat((function(e){return Object(l.e)(e,\"long\"===t.format?\"short\":t.format)}))).selectAll(\".tick text\").style(\"text-anchor\",\"middle\").attr(\"font-size\",10/x),k.select(\".circle-axis\").call((function(t){return t.select(\".domain\").remove()}))}else if(r===s.p.SPIKE){var T=Object(g.a)(a.current),S=n.ticks(3).slice(1).reverse(),M=28/x;T.select(\".spikes\").attr(\"transform\",\"translate(32,24)\").selectAll(\"g\").data(S).join((function(t){return t.append(\"g\").call((function(t){return t.append(\"path\").attr(\"fill-opacity\",.3).attr(\"d\",(function(t){return Object(l.l)(0)}))}))})).attr(\"transform\",(function(t,e){return\"translate(\".concat(e*M,\",0)\")})).call((function(e){return e.select(\"path\").transition(i).attr(\"d\",(function(t){return Object(l.l)(n(t))})).attr(\"fill\",t.color+\"70\").attr(\"stroke\",t.color+\"70\")}));var H=n.copy().range([M*S.length,0]);T.select(\".spike-axis\").attr(\"transform\",\"translate(32,32)\").transition(i).call(Object(f.a)(H).tickSize(0).tickPadding(0).tickValues(S).tickFormat((function(e){return Object(l.e)(e,\"long\"===t.format?\"short\":t.format)}))).selectAll(\".tick text\").style(\"text-anchor\",\"middle\").attr(\"font-size\",10/x),T.select(\".spike-axis\").call((function(t){return t.select(\".domain\").remove()}))}else{var P,z=Object(g.a)(c.current);z.call((function(){return function(){var t,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=e.svg,n=e.color,i=e.title,a=e.tickSize,c=void 0===a?6:a,o=e.width,l=void 0===o?320:o,g=e.height,x=void 0===g?44+c:g,k=e.marginTop,y=void 0===k?18:k,w=e.marginRight,C=void 0===w?0:w,E=e.marginBottom,N=void 0===E?16+c:E,T=e.marginLeft,R=void 0===T?0:T,S=e.ticks,M=void 0===S?l/64:S,H=e.tickFormat,P=e.tickValues,z=e.ordinalWeights,B=r.transition().duration(s.c),L=function(t){t.selectAll(\".tick line\").attr(\"y1\",y+N-x)};if(n.interpolate){var _=Math.min(n.domain().length,n.range().length);t=n.copy().rangeRound(Object(j.a)(Object(b.a)(R,l-C),_)),r.select(\".ramp\").attr(\"x\",R).attr(\"y\",y).attr(\"width\",l-R-C).attr(\"height\",x-y-N).attr(\"xlink:href\",A(n.copy().domain(Object(j.a)(Object(b.a)(0,1),_))).toDataURL())}else if(n.interpolator){if(r.select(\".bars\").selectAll(\"rect\").transition(B).attr(\"opacity\",0).remove(),t=Object.assign(n.copy().interpolator(Object(m.a)(R,l-C)),{range:function(){return[R,l-C]}}),r.select(\".ramp\").attr(\"x\",R).attr(\"y\",y).attr(\"width\",l-R-C).attr(\"height\",x-y-N).attr(\"xlink:href\",A(n.interpolator()).toDataURL()).attr(\"display\",\"visible\").transition(B).attr(\"opacity\",1),!t.ticks){if(void 0===P){var F=Math.round(M+1);P=Object(u.a)(F).map((function(t){return Object(d.a)(n.domain(),t/(F-1))}))}\"function\"!==typeof H&&(H=Object(p.a)(void 0===H?\",f\":H))}}else if(n.invertExtent){var I=n.thresholds?n.thresholds():n.quantiles?n.quantiles():n.domain(),U=void 0===H?function(t){return t}:\"string\"===typeof H?Object(p.a)(H):H;t=Object(v.a)().domain([-1,n.range().length-1]).rangeRound([R,l-C]),r.append(\"g\").selectAll(\"rect\").data(n.range()).join(\"rect\").attr(\"x\",(function(e,r){return t(r-1)})).attr(\"y\",y).attr(\"width\",(function(e,r){return t(r)-t(r-1)})).attr(\"height\",x-y-N).attr(\"fill\",(function(t){return t})),P=Object(u.a)(-1,I.length),H=function(t){return-1===t?U(1):t!==I.length-1?t===I.length-2?U(I[t]+\"+\",t):U(I[t],t):void 0}}else{if(r.select(\".ramp\").transition(B).attr(\"opacity\",0).attr(\"xlink:href\",null),z){var V=Object(v.a)().domain([0,z.reduce((function(t,e){return t+e}))]).rangeRound([0,l-R-C]),D=z.map((function(t,e){return z.slice(0,e).reduce((function(t,e){return t+V(e)}),R)}));t=Object(h.a)().domain(n.domain()).range(D),r.select(\".bars\").selectAll(\"rect\").data(n.domain()).join((function(e){return e.append(\"rect\").attr(\"x\",t).attr(\"width\",(function(t,e){return V(z[e])}))})).attr(\"y\",y).attr(\"height\",x-y-N).attr(\"fill\",n).transition(B).attr(\"x\",t).attr(\"width\",(function(t,e){return V(z[e])})).attr(\"opacity\",1)}else t=Object(O.a)().domain(n.domain().filter((function(t){return t}))).rangeRound([R,l-C]),r.select(\".bars\").selectAll(\"rect\").data(n.domain().filter((function(t){return t}))).join(\"rect\").attr(\"x\",t).attr(\"y\",y).attr(\"width\",Math.max(0,t.bandwidth()-1)).attr(\"height\",x-y-N).attr(\"fill\",n);L=function(){}}return r.select(\".axis\").attr(\"transform\",\"translate(0,\".concat(x-N,\")\")).transition(B).attr(\"class\",\"axis\").call(Object(f.a)(t).ticks(M,\"string\"===typeof H?H:void 0).tickFormat(\"function\"===typeof H?H:void 0).tickSize(c).tickValues(P)).on(\"start\",(function(){r.call(L).call((function(t){return t.select(\".domain\").remove()}))})).call((function(t){return t.select(\".axistext\").attr(\"class\",\"axistext\").attr(\"x\",R).attr(\"y\",y+N-x-6).attr(\"fill\",\"currentColor\").attr(\"text-anchor\",\"start\").attr(\"font-weight\",\"bold\").text(i)})),r.node()}({svg:z,color:n,width:R,height:s.k,ticks:5,tickFormat:function(e,n,i){var a;return(null===t||void 0===t||null===(a=t.mapConfig)||void 0===a?void 0:a.colorScale)?e:r!==s.p.CHOROPLETH||Number.isInteger(e)?n===i.length-1?Object(l.e)(e,t.format)+\"+\":Object(l.e)(e,t.format):\"\"},marginLeft:2,marginRight:0})})),z.attr(\"class\",(null===t||void 0===t||null===(P=t.mapConfig)||void 0===P?void 0:P.colorScale)?\"zone\":\"\")}}}),[i,R,e,n,r]),Object(C.jsxs)(\"div\",{className:\"svg-parent maplegend\",ref:T,style:{height:2*s.k},children:[Object(C.jsxs)(\"svg\",{id:\"legend\",preserveAspectRatio:\"xMinYMid meet\",ref:a,viewBox:\"0 0 \".concat(s.j[0],\" \").concat(s.k),children:[Object(C.jsx)(\"g\",{className:\"circles\"}),Object(C.jsx)(\"g\",{className:\"spikes\"}),Object(C.jsx)(\"g\",{className:\"circle-axis\"}),Object(C.jsx)(\"g\",{className:\"spike-axis\"}),Object(C.jsx)(\"g\",{className:\"axis\",children:Object(C.jsx)(\"text\",{className:\"axistext\"})})]}),Object(C.jsxs)(\"svg\",{id:\"legend-choro\",preserveAspectRatio:\"xMinYMid meet\",ref:c,children:[Object(C.jsx)(\"image\",{className:\"ramp\",preserveAspectRatio:\"none\"}),Object(C.jsx)(\"g\",{className:\"bars\"}),Object(C.jsx)(\"g\",{className:\"axis\",children:Object(C.jsx)(\"text\",{className:\"axistext\"})})]}),Object(C.jsx)(\"canvas\",{className:\"color-scale\",style:{position:\"absolute\",height:0}})]})};function A(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:256,r=Object(g.a)(\".color-scale\").node(),n=(r.width=e,r.height=1,r).getContext(\"2d\"),i=0;i<e;++i)n.fillStyle=t(i/(e-1)),n.fillRect(i,0,1,1);return r}var N=r(95),T=r(94),R=r.n(T),S=r(163),M=r(214),H=r(227),P=r(225),z=r(168),B=r(234),L=r(207),_=r(208),F=r(209),I=r(210),U=r(211),V=r(212),D=r(213),K=r(5),Y=r(116),q=r(172);e.default=function(t){var e,r=this,i=t.mapCode,o=t.isDistrictView,u=t.mapViz,d=t.data,f=t.regionHighlighted,p=t.setRegionHighlighted,j=t.statistic,b=t.getMapStatistic,m=t.transformStatistic,O=t.noDistrictData,h=Object(y.a)().t,w=Object(k.useRef)(null),A=s.l[i],T=Object(K.g)(),W=Object(Y.a)(A.geoDataFile,function(){var t=Object(c.a)(a.a.mark((function t(e){var r;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(M.a)(e);case 2:return r=t.sent,console.log(r),t.abrupt(\"return\",r);case 5:case\"end\":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),{suspense:!1,revalidateOnFocus:!1}).data,J=Object(k.useMemo)((function(){return b(d[i])}),[d,i,b]),G=s.w[j],Q=Object(k.useCallback)((function(t){return((null===G||void 0===G?void 0:G.color)||\"#343a40\")+t}),[G]),X=Object(k.useMemo)((function(){return W?(o?A.mapType===s.n.COUNTRY&&u!==s.p.CHOROPLETH?[].concat(Object(n.a)(Object(q.a)(W,W.objects.states).features),Object(n.a)(Object(q.a)(W,W.objects.districts).features)):Object(q.a)(W,W.objects.districts).features:Object(q.a)(W,W.objects.states).features).map((function(t){var e=t.properties.district,r=t.properties.st_nm,n=Object.assign({},t);return n.id=\"\".concat(i,\"-\").concat(r).concat(e?\"-\"+e:\"\"),n})):null}),[W,i,o,u,A]),Z=Object(k.useMemo)((function(){return W&&o?Object(q.a)(W,W.objects.districts).features.reduce((function(t,e){var r=s.u[e.properties.st_nm];return t[r]||(t[r]=new Set),t[r].add(e.properties.district),t}),{}):{}}),[W,o]),$=Object(k.useMemo)((function(){var t=Object.keys(d).filter((function(t){return\"TT\"!==t&&Object.keys(s.l).includes(t)}));if(o){var e=t.reduce((function(t,e){var r,i=Object.keys((null===(r=d[e])||void 0===r?void 0:r.districts)||[]).filter((function(t){return((null===Z||void 0===Z?void 0:Z[e])||new Set).has(t)||u!==s.p.CHOROPLETH&&t===s.z}));return t.push.apply(t,Object(n.a)(i.map((function(t){return m(b(d[e].districts[t]))})))),t}),[]);return Object(S.a)(e)}return Object(S.a)(t,(function(t){return m(b(d[t]))}))}),[d,o,b,u,Z,m]),tt=Object(k.useMemo)((function(){var t,e;return u===s.p.BUBBLE?Object(z.b)([0,Math.max(1,$||0)],[0,40]).clamp(!0).nice(3):u===s.p.SPIKE?Object(v.a)([0,Math.max(1,$||0)],[0,80]).clamp(!0).nice(3):(null===(t=s.w[j])||void 0===t||null===(e=t.mapConfig)||void 0===e?void 0:e.colorScale)?s.w[j].mapConfig.colorScale:Object(B.a)([0,Math.max(1,$||0)],function(t){var e;return\"confirmed\"===t?function(t){return Object(L.a)(.85*t)}:\"active\"===t?function(t){return Object(_.a)(.85*t)}:\"recovered\"===t?function(t){return Object(F.a)(.85*t)}:\"deceased\"===t?function(t){return Object(I.a)(.85*t)}:\"tested\"===t?function(t){return Object(U.a)(.85*t)}:\"tpr\"===t||\"cfr\"===t||\"other\"===t?function(t){return Object(V.a)(.85*t)}:\"vaccinated\"===(null===(e=s.w[t])||void 0===e?void 0:e.category)?function(t){return Object(D.a)(.15+.35*(1-t))}:function(t){return Object(V.a)(.85*t)}}(j)).clamp(!0)}),[u,j,$]),et=Object(k.useCallback)((function(t){if(u===s.p.CHOROPLETH){var e,r=s.u[t.properties.st_nm],n=t.properties.district,i=d[r],a=null===i||void 0===i||null===(e=i.districts)||void 0===e?void 0:e[n],c=m(b(n?a:i));return c?tt(c):\"#ffffff00\"}}),[u,d,tt,b,m]),rt=Object(k.useCallback)((function(t){t.select(\"title\").text((function(t){if(u!==s.p.CHOROPLETH&&!(null===G||void 0===G?void 0:G.nonLinear)){var e,r,n=t.properties.st_nm,i=s.u[n],a=t.properties.district,c=d[i],o=null===c||void 0===c||null===(e=c.districts)||void 0===e?void 0:e[a];return r=b(a?o:c),\"\".concat(Object(l.e)(r/(J||.001)*100,\"%\"),\" from \").concat(Object(l.m)(a||n))}}))}),[u,d,b,J,G]),nt=Object(k.useRef)(null);Object(k.useEffect)((function(){Object(g.a)(w.current).attr(\"pointer-events\",\"auto\").on(\"click\",(function(){nt.current=null,p({stateCode:i,districtName:null})}))}),[i,p]);var it=Object(k.useMemo)((function(){return W?Object(H.a)(Object(P.a)()):null}),[W]);Object(k.useEffect)((function(){if(W){var t=Object(g.a)(w.current),e=Object(x.a)().duration(s.c);t.select(\".regions\").selectAll(\"path\").data(u===s.p.CHOROPLETH?X:[],(function(t){return t.id})).join((function(t){return t.append(\"path\").attr(\"d\",it).attr(\"stroke-width\",1.8).attr(\"stroke-opacity\",0).style(\"cursor\",\"pointer\").on(\"mouseenter\",(function(t,e){nt.current||p({stateCode:s.u[e.properties.st_nm],districtName:e.properties.district})})).on(\"pointerdown\",(function(t,e){nt.current===e?nt.current=null:nt.current=e,p({stateCode:s.u[e.properties.st_nm],districtName:e.properties.district})})).attr(\"fill\",\"#fff0\").attr(\"stroke\",\"#fff0\")}),(function(t){return t}),(function(t){return t.transition(e).attr(\"stroke\",\"#fff0\").attr(\"fill\",\"#fff0\").remove()})).attr(\"pointer-events\",\"all\").on(\"click\",(function(e,r){var n;e.stopPropagation();var i=s.u[r.properties.st_nm];!nt.current&&A.mapType!==s.n.STATE&&(null===(n=d[i])||void 0===n?void 0:n.districts)&&(t.attr(\"pointer-events\",\"none\"),t.select(\".regions\").selectAll(\"path\").attr(\"pointer-events\",\"none\"),T.push(\"/state/\".concat(i).concat(window.innerWidth<769?\"#MapExplorer\":\"\")))})).call((function(t){t.transition(e).attr(\"fill\",et).attr(\"stroke\",Q.bind(r,\"\"))}))}}),[u,d,X,et,W,T,A.mapType,it,p,Q]);var at=Object(k.useMemo)((function(){return u===s.p.CHOROPLETH?[]:(X||[]).map((function(t){var e=s.u[t.properties.st_nm],r=t.properties.district,n=d[e];if(o){var i,a,c=null===n||void 0===n||null===(i=n.districts)||void 0===i?void 0:i[r];t.value=b(r?c:null===n||void 0===n||null===(a=n.districts)||void 0===a?void 0:a[s.z])}else t.value=b(n);return t})).filter((function(t){return t.value>0})).sort((function(t,e){return e.value-e.value}))}),[u,o,b,X,d]);return Object(k.useEffect)((function(){var t=Object(g.a)(w.current),e=Object(x.a)().duration(s.c),r=t.select(\".circles\").selectAll(\"circle\").data(u===s.p.BUBBLE?at:[],(function(t){return t.id})).join((function(t){return t.append(\"circle\").attr(\"transform\",(function(t){return\"translate(\".concat(it.centroid(t),\")\")})).attr(\"fill-opacity\",.25).style(\"cursor\",\"pointer\").attr(\"pointer-events\",\"all\").call((function(t){t.append(\"title\")}))}),(function(t){return t}),(function(t){return t.call((function(t){return t.transition(e).attr(\"r\",0).remove()}))})).on(\"mouseenter\",(function(t,e){nt.current||p({stateCode:s.u[e.properties.st_nm],districtName:o?e.properties.district||s.z:null})})).on(\"pointerdown\",(function(t,e){nt.current===e?nt.current=null:nt.current=e,p({stateCode:s.u[e.properties.st_nm],districtName:o?e.properties.district||s.z:null})})).on(\"click\",(function(t,e){t.stopPropagation(),nt.current||A.mapType===s.n.STATE||T.push(\"/state/\".concat(s.u[e.properties.st_nm]).concat(window.innerWidth<769?\"#MapExplorer\":\"\"))})).call((function(t){t.transition(e).attr(\"fill\",G.color+\"70\").attr(\"stroke\",G.color+\"70\").attr(\"r\",(function(t){return tt(t.value)}))}));window.requestIdleCallback((function(){rt(r)}))}),[A.mapType,u,o,at,T,tt,it,p,rt,G,b]),Object(k.useEffect)((function(){var t=Object(g.a)(w.current),e=Object(x.a)().duration(s.c),r=t.select(\".spikes\").selectAll(\"path\").data(u===s.p.SPIKE?at:[],(function(t){return t.id}),(function(t){return t.id})).join((function(t){return t.append(\"path\").attr(\"transform\",(function(t){return\"translate(\".concat(it.centroid(t),\")\")})).attr(\"opacity\",0).attr(\"fill-opacity\",.25).style(\"cursor\",\"pointer\").attr(\"pointer-events\",\"all\").attr(\"d\",Object(l.l)(0)).call((function(t){t.append(\"title\")}))}),(function(t){return t}),(function(t){return t.call((function(t){return t.transition(e).attr(\"opacity\",0).attr(\"d\",Object(l.l)(0)).remove()}))})).on(\"mouseenter\",(function(t,e){nt.current||p({stateCode:s.u[e.properties.st_nm],districtName:o?e.properties.district||s.z:null})})).on(\"pointerdown\",(function(t,e){nt.current===e?nt.current=null:nt.current=e,p({stateCode:s.u[e.properties.st_nm],districtName:o?e.properties.district||s.z:null})})).on(\"click\",(function(t,e){t.stopPropagation(),nt.current||A.mapType===s.n.STATE||T.push(\"/state/\".concat(s.u[e.properties.st_nm]).concat(window.innerWidth<769?\"#MapExplorer\":\"\"))})).call((function(t){t.transition(e).attr(\"opacity\",1).attr(\"fill\",G.color+\"70\").attr(\"stroke\",G.color+\"70\").attr(\"d\",(function(t){return Object(l.l)(tt(t.value))}))}));window.requestIdleCallback((function(){rt(r)}))}),[A.mapType,u,o,at,T,tt,it,p,rt,G,b]),Object(k.useEffect)((function(){if(W){var t=Object(g.a)(w.current),e=Object(x.a)().duration(s.c),n=[],a=[];A.mapType===s.n.COUNTRY&&((n=[Object(q.b)(W,W.objects.states)])[0].id=\"\".concat(i,\"-states\")),(A.mapType===s.n.STATE||o&&u===s.p.CHOROPLETH)&&((a=[Object(q.b)(W,W.objects.districts)])[0].id=\"\".concat(i,\"-districts\")),t.select(\".state-borders\").attr(\"fill\",\"none\").attr(\"stroke-width\",1.5).selectAll(\"path\").data(n,(function(t){return t.id})).join((function(t){return t.append(\"path\").attr(\"d\",it).attr(\"stroke\",\"#fff0\")}),(function(t){return t}),(function(t){return t.transition(e).attr(\"stroke\",\"#fff0\").remove()})).transition(e).attr(\"stroke\",Q.bind(r,\"40\")),t.select(\".district-borders\").attr(\"fill\",\"none\").attr(\"stroke-width\",1.5).selectAll(\"path\").data(a,(function(t){return t.id})).join((function(t){return t.append(\"path\").attr(\"d\",it).attr(\"d\",it).attr(\"stroke\",\"#fff0\")}),(function(t){return t}),(function(t){return t.transition(e).attr(\"stroke\",\"#fff0\").remove()})).transition(e).attr(\"stroke\",Q.bind(r,\"40\"))}}),[W,A,i,u,o,j,it,Q]),Object(k.useEffect)((function(){var t=f.stateCode,e=s.v[t],r=f.districtName,n=Object(g.a)(w.current);u===s.p.BUBBLE?n.select(\".circles\").selectAll(\"circle\").attr(\"fill-opacity\",(function(n){var a;return e===n.properties.st_nm&&(!r&&t!==i||r===(null===(a=n.properties)||void 0===a?void 0:a.district)||!o||r===s.z&&!n.properties.district)?1:.25})):u===s.p.SPIKE?n.select(\".spikes\").selectAll(\"path\").attr(\"fill-opacity\",(function(n){var a;return e===n.properties.st_nm&&(!r&&t!==i||r===(null===(a=n.properties)||void 0===a?void 0:a.district)||!o||r===s.z&&!n.properties.district)?1:.25})):n.select(\".regions\").selectAll(\"path\").each((function(n){var a,c=e===n.properties.st_nm&&(!r&&t!==i||r===(null===(a=n.properties)||void 0===a?void 0:a.district)||!o);c&&this.parentNode.appendChild(this),Object(g.a)(this).attr(\"stroke-opacity\",c?1:0)}))}),[W,d,i,o,u,f.stateCode,f.districtName,j]),Object(C.jsxs)(C.Fragment,{children:[Object(C.jsxs)(\"div\",{className:\"svg-parent\",children:[Object(C.jsxs)(\"svg\",{id:\"chart\",className:R()({zone:!!(null===G||void 0===G||null===(e=G.mapConfig)||void 0===e?void 0:e.colorScale)}),viewBox:\"0 0 \".concat(s.j[0],\" \").concat(s.j[1]),preserveAspectRatio:\"xMidYMid meet\",ref:w,children:[Object(C.jsx)(\"g\",{className:\"regions\"}),Object(C.jsx)(\"g\",{className:\"state-borders\"}),Object(C.jsx)(\"g\",{className:\"district-borders\"}),Object(C.jsx)(\"g\",{className:\"circles\"}),Object(C.jsx)(\"g\",{className:\"spikes\"})]}),O&&(null===G||void 0===G?void 0:G.hasPrimary)&&Object(C.jsxs)(\"div\",{className:R()(\"disclaimer\",\"is-\".concat(j)),children:[Object(C.jsx)(N.a,{}),Object(C.jsx)(\"span\",{children:h(\"District-wise data not available in state bulletin\")})]})]}),tt&&Object(C.jsx)(E,{data:d,statistic:j,mapViz:u,mapScale:tt}),Object(C.jsx)(\"svg\",{style:{position:\"absolute\",height:0},children:Object(C.jsx)(\"defs\",{children:Object(C.jsx)(\"filter\",{id:\"balance-color\",colorInterpolationFilters:\"sRGB\",children:Object(C.jsx)(\"feColorMatrix\",{type:\"matrix\",values:\"0.91372549  0           0            0  0.08627451 0           0.91372549  0            0  0.08627451 0           0           0.854901961  0  0.145098039 0           0           0            1  0\"})})})})]})}}}]);","name":"static/js/21.f5cee965.chunk.js","map":{"version":3,"sources":["static/js/21.f5cee965.chunk.js"],"names":["this","push","module","__webpack_exports__","__webpack_require__","r","toConsumableArray","regenerator","regenerator_default","n","asyncToGenerator","slicedToArray","constants","commonFunctions","range","quantile","axis","defaultLocale","quantize","value","round","linear","band","ordinal","src_select","src","react","useTranslation","useMeasure","jsx_runtime","components_MapLegend","_ref","data","statistic","mapViz","mapScale","t","Object","svgLegendRef","svgLegendChoroRef","_useMeasure","_useMeasure2","wrapperRef","width","duration","CHOROPLETH","svg","current","select","transition","attr","selectAll","remove","text","BUBBLE","_svg","SPIKES","_svg2","call","g","statisticConfig","zoom","_mapScale$domain","domain","domainMax","_legend","legendRadius","map","d","join","color","yScale","copy","tickSize","tickPadding","tickValues","tickFormat","num","format","style","SPIKE","_svg3","ticks","slice","reverse","gap","enter","append","i","concat","xScale","length","_statisticConfig$mapC2","_svg4","x","_ref2","arguments","undefined","title","_ref2$tickSize","_ref2$width","_ref2$height","height","_ref2$marginTop","marginTop","_ref2$marginRight","marginRight","_ref2$marginBottom","marginBottom","_ref2$marginLeft","marginLeft","_ref2$ticks","ordinalWeights","tickAdjust","interpolate","Math","min","rangeRound","ramp","toDataURL","interpolator","assign","_n","invertExtent","thresholds","quantiles","thresholdFormat","widthScale","reduce","a","b","xPos","w","acc","filter","max","bandwidth","on","node","legend","_statisticConfig$mapC","mapConfig","colorScale","Number","isInteger","className","ref","children","id","preserveAspectRatio","viewBox","position","canvas","context","getContext","fillStyle","fillRect","index_esm","classnames","classnames_default","json","src_path","identity","pow","sequential","Reds","Blues","Greens","Greys","Purples","Oranges","PiYG","react_router","esm","topojson_client_src","_this","mapCode","isDistrictView","regionHighlighted","setRegionHighlighted","getMapStatistic","transformStatistic","noDistrictData","svgRef","mapMeta","history","geoData","geoDataFile","mark","_callee","file","wrap","_context","prev","next","sent","console","log","abrupt","stop","_x","apply","suspense","revalidateOnFocus","statisticTotal","strokeColor","alpha","features","mapType","COUNTRY","objects","states","districts","feature","district","properties","state","st_nm","obj","districtsSet","stateCodes","stateCode","Set","add","statisticMax","keys","includes","districtData","res","_data$stateCode","districtName","has","_STATISTIC_CONFIGS$st2","_STATISTIC_CONFIGS$st3","clamp","nice","_STATISTIC_CONFIGS$st","category","MapVisualizer_colorInterpolator","fillColor","_stateData$districts","stateData","populateTexts","regionSelection","nonLinear","_stateData$districts2","onceTouchedRegion","path","T","event","update","exit","_data$stateCode2","stopPropagation","STATE","window","innerWidth","sel","bind","sortedFeatures","_stateData$districts3","_stateData$districts4","sort","featureA","featureB","centroid","requestIdleCallback","meshStates","meshDistricts","stateName","_d$properties","_d$properties2","each","_d$properties3","highlighted","parentNode","appendChild","zone","hasPrimary","colorInterpolationFilters","type","values"],"mappings":"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"},"input":"(this[\"webpackJsonpd3ia\"] = this[\"webpackJsonpd3ia\"] || []).push([[21],{\n\n/***/ 240:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray.js + 3 modules\nvar toConsumableArray = __webpack_require__(109);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator/index.js\nvar regenerator = __webpack_require__(105);\nvar regenerator_default = /*#__PURE__*/__webpack_require__.n(regenerator);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\nvar asyncToGenerator = __webpack_require__(122);\n\n// EXTERNAL MODULE: ./node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js + 3 modules\nvar slicedToArray = __webpack_require__(46);\n\n// EXTERNAL MODULE: ./src/constants.js\nvar constants = __webpack_require__(11);\n\n// EXTERNAL MODULE: ./src/utils/commonFunctions.js\nvar commonFunctions = __webpack_require__(24);\n\n// EXTERNAL MODULE: ./node_modules/d3-array/src/range.js\nvar range = __webpack_require__(205);\n\n// EXTERNAL MODULE: ./node_modules/d3-array/src/quantile.js + 4 modules\nvar quantile = __webpack_require__(230);\n\n// EXTERNAL MODULE: ./node_modules/d3-axis/src/axis.js + 1 modules\nvar axis = __webpack_require__(241);\n\n// EXTERNAL MODULE: ./node_modules/d3-format/src/defaultLocale.js + 8 modules\nvar defaultLocale = __webpack_require__(224);\n\n// EXTERNAL MODULE: ./node_modules/d3-interpolate/src/quantize.js\nvar quantize = __webpack_require__(204);\n\n// EXTERNAL MODULE: ./node_modules/d3-interpolate/src/value.js + 4 modules\nvar value = __webpack_require__(231);\n\n// EXTERNAL MODULE: ./node_modules/d3-interpolate/src/round.js\nvar round = __webpack_require__(199);\n\n// EXTERNAL MODULE: ./node_modules/d3-scale/src/linear.js + 4 modules\nvar linear = __webpack_require__(117);\n\n// EXTERNAL MODULE: ./node_modules/d3-scale/src/band.js\nvar band = __webpack_require__(206);\n\n// EXTERNAL MODULE: ./node_modules/d3-scale/src/ordinal.js + 1 modules\nvar ordinal = __webpack_require__(80);\n\n// EXTERNAL MODULE: ./node_modules/d3-selection/src/select.js\nvar src_select = __webpack_require__(201);\n\n// EXTERNAL MODULE: ./node_modules/d3-transition/src/index.js + 34 modules\nvar src = __webpack_require__(115);\n\n// EXTERNAL MODULE: ./node_modules/react/index.js\nvar react = __webpack_require__(2);\n\n// EXTERNAL MODULE: ./node_modules/react-i18next/dist/es/useTranslation.js + 1 modules\nvar useTranslation = __webpack_require__(236);\n\n// EXTERNAL MODULE: ./node_modules/react-use/esm/useMeasure.js + 1 modules\nvar useMeasure = __webpack_require__(141);\n\n// EXTERNAL MODULE: ./node_modules/react/jsx-runtime.js\nvar jsx_runtime = __webpack_require__(21);\n\n// CONCATENATED MODULE: ./src/components/MapLegend.js\nfunction MapLegend(_ref){var data=_ref.data,statistic=_ref.statistic,mapViz=_ref.mapViz,mapScale=_ref.mapScale;var _useTranslation=Object(useTranslation[\"a\" /* useTranslation */])(),t=_useTranslation.t;var svgLegendRef=Object(react[\"useRef\"])(null);var svgLegendChoroRef=Object(react[\"useRef\"])(null);var _useMeasure=Object(useMeasure[\"a\" /* default */])(),_useMeasure2=Object(slicedToArray[\"a\" /* default */])(_useMeasure,2),wrapperRef=_useMeasure2[0],width=_useMeasure2[1].width;Object(react[\"useEffect\"])(function(){var t=Object(src[\"a\" /* transition */])().duration(constants[\"c\" /* D3_TRANSITION_DURATION */]);if(mapViz!==constants[\"p\" /* MAP_VIZS */].CHOROPLETH){var svg=Object(src_select[\"a\" /* default */])(svgLegendChoroRef.current);svg.select('.ramp').transition(t).attr('opacity',0).attr('display','none').attr('xlink:href',null);svg.select('.bars').selectAll('rect').transition(t).attr('opacity',0).remove();svg.selectAll('.axis > *:not(.axistext)').remove();svg.select('.axistext').text('');}if(mapViz!==constants[\"p\" /* MAP_VIZS */].BUBBLE){var _svg=Object(src_select[\"a\" /* default */])(svgLegendRef.current);_svg.select('.circles').selectAll('circle').transition(t).attr('r',0).attr('cy',0).remove();_svg.selectAll('.circle-axis > *').remove();}if(mapViz!==constants[\"p\" /* MAP_VIZS */].SPIKES){var _svg2=Object(src_select[\"a\" /* default */])(svgLegendRef.current);_svg2.select('.spikes').call(function(g){return g.selectAll('path').transition(t).attr('d',Object(commonFunctions[\"l\" /* spike */])(0)).remove();}).call(function(g){return g.selectAll('text').remove();}).transition(t).selectAll('g').remove();_svg2.selectAll('.spike-axis > *').remove();}},[mapViz]);Object(react[\"useEffect\"])(function(){if(!width)return;var statisticConfig=constants[\"w\" /* STATISTIC_CONFIGS */][statistic];var zoom=width/constants[\"j\" /* MAP_DIMENSIONS */][0];if(mapViz===constants[\"p\" /* MAP_VIZS */].BUBBLE){var svg=Object(src_select[\"a\" /* default */])(svgLegendRef.current);var _mapScale$domain=mapScale.domain(),_mapScale$domain2=Object(slicedToArray[\"a\" /* default */])(_mapScale$domain,2),domainMax=_mapScale$domain2[1];var _legend=svg.select('.circles').attr('transform',\"translate(48,40)\").attr('text-anchor','middle');var legendRadius=[0.1,0.4,1].map(function(d){return d*domainMax;});_legend.selectAll('circle').data(legendRadius).join('circle').attr('fill','none').attr('stroke',statisticConfig.color+'70').transition(t).attr('cy',function(d){return-mapScale(d);}).attr('r',function(d){return mapScale(d);});var yScale=mapScale.copy().range([0,-2*mapScale(domainMax)]);svg.select('.circle-axis').attr('transform',\"translate(48,50)\").transition(t).call(Object(axis[\"b\" /* axisRight */])(yScale).tickSize(0).tickPadding(0).tickValues(legendRadius).tickFormat(function(num){return Object(commonFunctions[\"e\" /* formatNumber */])(num,statisticConfig.format==='long'?'short':statisticConfig.format);})).selectAll('.tick text').style('text-anchor','middle').attr('font-size',10/zoom);svg.select('.circle-axis').call(function(g){return g.select('.domain').remove();});}else if(mapViz===constants[\"p\" /* MAP_VIZS */].SPIKE){var _svg3=Object(src_select[\"a\" /* default */])(svgLegendRef.current);var ticks=mapScale.ticks(3).slice(1).reverse();var gap=28/zoom;_svg3.select('.spikes').attr('transform',\"translate(32,24)\").selectAll('g').data(ticks).join(function(enter){return enter.append('g').call(function(g){return g.append('path').attr('fill-opacity',0.3).attr('d',function(d){return Object(commonFunctions[\"l\" /* spike */])(0);});});}).attr('transform',function(d,i){return\"translate(\".concat(i*gap,\",0)\");}).call(function(g){return g.select('path').transition(t).attr('d',function(d){return Object(commonFunctions[\"l\" /* spike */])(mapScale(d));}).attr('fill',statisticConfig.color+'70').attr('stroke',statisticConfig.color+'70');});var xScale=mapScale.copy().range([gap*ticks.length,0]);_svg3.select('.spike-axis').attr('transform',\"translate(32,32)\").transition(t).call(Object(axis[\"a\" /* axisBottom */])(xScale).tickSize(0).tickPadding(0).tickValues(ticks).tickFormat(function(num){return Object(commonFunctions[\"e\" /* formatNumber */])(num,statisticConfig.format==='long'?'short':statisticConfig.format);})).selectAll('.tick text').style('text-anchor','middle').attr('font-size',10/zoom);_svg3.select('.spike-axis').call(function(g){return g.select('.domain').remove();});}else{var _statisticConfig$mapC2;var _svg4=Object(src_select[\"a\" /* default */])(svgLegendChoroRef.current);_svg4.call(function(){return legend({svg:_svg4,color:mapScale,width:width,height:constants[\"k\" /* MAP_LEGEND_HEIGHT */],ticks:5,tickFormat:function tickFormat(d,i,n){var _statisticConfig$mapC;if(statisticConfig===null||statisticConfig===void 0?void 0:(_statisticConfig$mapC=statisticConfig.mapConfig)===null||_statisticConfig$mapC===void 0?void 0:_statisticConfig$mapC.colorScale){return d;}else if(mapViz===constants[\"p\" /* MAP_VIZS */].CHOROPLETH&&!Number.isInteger(d)){return'';}else if(i===n.length-1){return Object(commonFunctions[\"e\" /* formatNumber */])(d,statisticConfig.format)+'+';}else{return Object(commonFunctions[\"e\" /* formatNumber */])(d,statisticConfig.format);}},marginLeft:2,marginRight:0});});_svg4.attr('class',(statisticConfig===null||statisticConfig===void 0?void 0:(_statisticConfig$mapC2=statisticConfig.mapConfig)===null||_statisticConfig$mapC2===void 0?void 0:_statisticConfig$mapC2.colorScale)?'zone':'');}},[t,width,statistic,mapScale,mapViz]);return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"svg-parent maplegend\",ref:wrapperRef,style:{height:2*constants[\"k\" /* MAP_LEGEND_HEIGHT */]},children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"svg\",{id:\"legend\",preserveAspectRatio:\"xMinYMid meet\",ref:svgLegendRef,viewBox:\"0 0 \".concat(constants[\"j\" /* MAP_DIMENSIONS */][0],\" \").concat(constants[\"k\" /* MAP_LEGEND_HEIGHT */]),children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"g\",{className:\"circles\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"g\",{className:\"spikes\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"g\",{className:\"circle-axis\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"g\",{className:\"spike-axis\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"g\",{className:\"axis\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"text\",{className:\"axistext\"})})]}),/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"svg\",{id:\"legend-choro\",preserveAspectRatio:\"xMinYMid meet\",ref:svgLegendChoroRef,children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"image\",{className:\"ramp\",preserveAspectRatio:\"none\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"g\",{className:\"bars\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"g\",{className:\"axis\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"text\",{className:\"axistext\"})})]}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"canvas\",{className:\"color-scale\",style:{position:'absolute',height:0}})]});}/* harmony default export */ var components_MapLegend = (MapLegend);function legend(){var _ref2=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{},svg=_ref2.svg,color=_ref2.color,title=_ref2.title,_ref2$tickSize=_ref2.tickSize,tickSize=_ref2$tickSize===void 0?6:_ref2$tickSize,_ref2$width=_ref2.width,width=_ref2$width===void 0?320:_ref2$width,_ref2$height=_ref2.height,height=_ref2$height===void 0?44+tickSize:_ref2$height,_ref2$marginTop=_ref2.marginTop,marginTop=_ref2$marginTop===void 0?18:_ref2$marginTop,_ref2$marginRight=_ref2.marginRight,marginRight=_ref2$marginRight===void 0?0:_ref2$marginRight,_ref2$marginBottom=_ref2.marginBottom,marginBottom=_ref2$marginBottom===void 0?16+tickSize:_ref2$marginBottom,_ref2$marginLeft=_ref2.marginLeft,marginLeft=_ref2$marginLeft===void 0?0:_ref2$marginLeft,_ref2$ticks=_ref2.ticks,ticks=_ref2$ticks===void 0?width/64:_ref2$ticks,tickFormat=_ref2.tickFormat,tickValues=_ref2.tickValues,ordinalWeights=_ref2.ordinalWeights;var t=svg.transition().duration(constants[\"c\" /* D3_TRANSITION_DURATION */]);var tickAdjust=function tickAdjust(g){var ticks=g.selectAll('.tick line');ticks.attr('y1',marginTop+marginBottom-height);// select(ticks.nodes()[ticks.size() - 1]).remove();\n};var x;// Continuous\nif(color.interpolate){var n=Math.min(color.domain().length,color.range().length);x=color.copy().rangeRound(Object(quantize[\"a\" /* default */])(Object(value[\"a\" /* default */])(marginLeft,width-marginRight),n));svg.select('.ramp').attr('x',marginLeft).attr('y',marginTop).attr('width',width-marginLeft-marginRight).attr('height',height-marginTop-marginBottom).attr('xlink:href',ramp(color.copy().domain(Object(quantize[\"a\" /* default */])(Object(value[\"a\" /* default */])(0,1),n))).toDataURL());}// Sequential\nelse if(color.interpolator){svg.select('.bars').selectAll('rect').transition(t).attr('opacity',0).remove();x=Object.assign(color.copy().interpolator(Object(round[\"a\" /* default */])(marginLeft,width-marginRight)),{range:function range(){return[marginLeft,width-marginRight];}});svg.select('.ramp').attr('x',marginLeft).attr('y',marginTop).attr('width',width-marginLeft-marginRight).attr('height',height-marginTop-marginBottom).attr('xlink:href',ramp(color.interpolator()).toDataURL()).attr('display','visible').transition(t).attr('opacity',1);// scaleSequentialQuantile doesnt implement ticks or tickFormat.\nif(!x.ticks){if(tickValues===undefined){var _n=Math.round(ticks+1);tickValues=Object(range[\"a\" /* default */])(_n).map(function(i){return Object(quantile[\"a\" /* default */])(color.domain(),i/(_n-1));});}if(typeof tickFormat!=='function'){tickFormat=Object(defaultLocale[\"a\" /* format */])(tickFormat===undefined?',f':tickFormat);}}}// Threshold\nelse if(color.invertExtent){var thresholds=color.thresholds?color.thresholds()// scaleQuantize\n:color.quantiles?color.quantiles()// scaleQuantile\n:color.domain();// scaleThreshold\nvar thresholdFormat=tickFormat===undefined?function(d){return d;}:typeof tickFormat==='string'?Object(defaultLocale[\"a\" /* format */])(tickFormat):tickFormat;x=Object(linear[\"a\" /* default */])().domain([-1,color.range().length-1]).rangeRound([marginLeft,width-marginRight]);svg.append('g').selectAll('rect').data(color.range()).join('rect').attr('x',function(d,i){return x(i-1);}).attr('y',marginTop).attr('width',function(d,i){return x(i)-x(i-1);}).attr('height',height-marginTop-marginBottom).attr('fill',function(d){return d;});tickValues=Object(range[\"a\" /* default */])(-1,thresholds.length);tickFormat=function tickFormat(i){if(i===-1)return thresholdFormat(1);else if(i===thresholds.length-1)return;else if(i===thresholds.length-2)return thresholdFormat(thresholds[i]+'+',i);return thresholdFormat(thresholds[i],i);};}// Ordinal\nelse{svg.select('.ramp').transition(t).attr('opacity',0).attr('xlink:href',null);if(!ordinalWeights){x=Object(band[\"a\" /* default */])().domain(color.domain().filter(function(d){return d;})).rangeRound([marginLeft,width-marginRight]);svg.select('.bars').selectAll('rect').data(color.domain().filter(function(d){return d;})).join('rect').attr('x',x).attr('y',marginTop).attr('width',Math.max(0,x.bandwidth()-1)).attr('height',height-marginTop-marginBottom).attr('fill',color);}else{var widthScale=Object(linear[\"a\" /* default */])().domain([0,ordinalWeights.reduce(function(a,b){return a+b;})]).rangeRound([0,width-marginLeft-marginRight]);var xPos=ordinalWeights.map(function(w,i){return ordinalWeights.slice(0,i).reduce(function(acc,w){return acc+widthScale(w);},marginLeft);});x=Object(ordinal[\"a\" /* default */])().domain(color.domain()).range(xPos);svg.select('.bars').selectAll('rect').data(color.domain()).join(function(enter){return enter.append('rect').attr('x',x).attr('width',function(d,i){return widthScale(ordinalWeights[i]);});}).attr('y',marginTop).attr('height',height-marginTop-marginBottom).attr('fill',color).transition(t).attr('x',x).attr('width',function(d,i){return widthScale(ordinalWeights[i]);}).attr('opacity',1);}tickAdjust=function tickAdjust(){};}svg.select('.axis').attr('transform',\"translate(0,\".concat(height-marginBottom,\")\")).transition(t).attr('class','axis').call(Object(axis[\"a\" /* axisBottom */])(x).ticks(ticks,typeof tickFormat==='string'?tickFormat:undefined).tickFormat(typeof tickFormat==='function'?tickFormat:undefined).tickSize(tickSize).tickValues(tickValues)).on('start',function(){svg.call(tickAdjust).call(function(svg){return svg.select('.domain').remove();});}).call(function(g){return g.select('.axistext').attr('class','axistext').attr('x',marginLeft).attr('y',marginTop+marginBottom-height-6).attr('fill','currentColor').attr('text-anchor','start').attr('font-weight','bold').text(title);});return svg.node();}function ramp(color){var n=arguments.length>1&&arguments[1]!==undefined?arguments[1]:256;var canvas=Object(src_select[\"a\" /* default */])('.color-scale').node();var context=(canvas.width=n,canvas.height=1,canvas).getContext('2d');for(var i=0;i<n;++i){context.fillStyle=color(i/(n-1));context.fillRect(i,0,1,1);}return canvas;}\n// EXTERNAL MODULE: ./node_modules/@primer/octicons-react/dist/index.esm.js\nvar index_esm = __webpack_require__(95);\n\n// EXTERNAL MODULE: ./node_modules/classnames/index.js\nvar classnames = __webpack_require__(94);\nvar classnames_default = /*#__PURE__*/__webpack_require__.n(classnames);\n\n// EXTERNAL MODULE: ./node_modules/d3-array/src/max.js\nvar max = __webpack_require__(163);\n\n// EXTERNAL MODULE: ./node_modules/d3-fetch/src/json.js\nvar json = __webpack_require__(214);\n\n// EXTERNAL MODULE: ./node_modules/d3-geo/src/path/index.js + 6 modules\nvar src_path = __webpack_require__(227);\n\n// EXTERNAL MODULE: ./node_modules/d3-geo/src/projection/identity.js + 8 modules\nvar identity = __webpack_require__(225);\n\n// EXTERNAL MODULE: ./node_modules/d3-scale/src/pow.js\nvar pow = __webpack_require__(168);\n\n// EXTERNAL MODULE: ./node_modules/d3-scale/src/sequential.js + 2 modules\nvar sequential = __webpack_require__(234);\n\n// EXTERNAL MODULE: ./node_modules/d3-scale-chromatic/src/sequential-single/Reds.js\nvar Reds = __webpack_require__(207);\n\n// EXTERNAL MODULE: ./node_modules/d3-scale-chromatic/src/sequential-single/Blues.js\nvar Blues = __webpack_require__(208);\n\n// EXTERNAL MODULE: ./node_modules/d3-scale-chromatic/src/sequential-single/Greens.js\nvar Greens = __webpack_require__(209);\n\n// EXTERNAL MODULE: ./node_modules/d3-scale-chromatic/src/sequential-single/Greys.js\nvar Greys = __webpack_require__(210);\n\n// EXTERNAL MODULE: ./node_modules/d3-scale-chromatic/src/sequential-single/Purples.js\nvar Purples = __webpack_require__(211);\n\n// EXTERNAL MODULE: ./node_modules/d3-scale-chromatic/src/sequential-single/Oranges.js\nvar Oranges = __webpack_require__(212);\n\n// EXTERNAL MODULE: ./node_modules/d3-scale-chromatic/src/diverging/PiYG.js\nvar PiYG = __webpack_require__(213);\n\n// EXTERNAL MODULE: ./node_modules/react-router/esm/react-router.js\nvar react_router = __webpack_require__(5);\n\n// EXTERNAL MODULE: ./node_modules/swr/esm/index.js + 9 modules\nvar esm = __webpack_require__(116);\n\n// EXTERNAL MODULE: ./node_modules/topojson-client/src/index.js + 12 modules\nvar topojson_client_src = __webpack_require__(172);\n\n// CONCATENATED MODULE: ./src/components/MapVisualizer.js\nvar MapVisualizer_colorInterpolator=function colorInterpolator(statistic){var _STATISTIC_CONFIGS$st;if(statistic==='confirmed'){return function(t){return Object(Reds[\"a\" /* default */])(t*0.85);};}else if(statistic==='active'){return function(t){return Object(Blues[\"a\" /* default */])(t*0.85);};}else if(statistic==='recovered'){return function(t){return Object(Greens[\"a\" /* default */])(t*0.85);};}else if(statistic==='deceased'){return function(t){return Object(Greys[\"a\" /* default */])(t*0.85);};}else if(statistic==='tested'){return function(t){return Object(Purples[\"a\" /* default */])(t*0.85);};}else if(statistic==='tpr'||statistic==='cfr'||statistic==='other'){return function(t){return Object(Oranges[\"a\" /* default */])(t*0.85);};}else if(((_STATISTIC_CONFIGS$st=constants[\"w\" /* STATISTIC_CONFIGS */][statistic])===null||_STATISTIC_CONFIGS$st===void 0?void 0:_STATISTIC_CONFIGS$st.category)==='vaccinated'){return function(t){return Object(PiYG[\"a\" /* default */])(0.15+0.35*(1-t));};}else{return function(t){return Object(Oranges[\"a\" /* default */])(t*0.85);};}};function MapVisualizer(_ref){var _this=this,_statisticConfig$mapC;var mapCode=_ref.mapCode,isDistrictView=_ref.isDistrictView,mapViz=_ref.mapViz,data=_ref.data,regionHighlighted=_ref.regionHighlighted,setRegionHighlighted=_ref.setRegionHighlighted,statistic=_ref.statistic,getMapStatistic=_ref.getMapStatistic,transformStatistic=_ref.transformStatistic,noDistrictData=_ref.noDistrictData;var _useTranslation=Object(useTranslation[\"a\" /* useTranslation */])(),t=_useTranslation.t;var svgRef=Object(react[\"useRef\"])(null);var mapMeta=constants[\"l\" /* MAP_META */][mapCode];var history=Object(react_router[\"g\" /* useHistory */])();var _useSWR=Object(esm[\"a\" /* default */])(mapMeta.geoDataFile,/*#__PURE__*/function(){var _ref2=Object(asyncToGenerator[\"a\" /* default */])(/*#__PURE__*/regenerator_default.a.mark(function _callee(file){var x;return regenerator_default.a.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return Object(json[\"a\" /* default */])(file);case 2:x=_context.sent;console.log(x);return _context.abrupt(\"return\",x);case 5:case\"end\":return _context.stop();}}},_callee);}));return function(_x){return _ref2.apply(this,arguments);};}(),{suspense:false,revalidateOnFocus:false}),geoData=_useSWR.data;var statisticTotal=Object(react[\"useMemo\"])(function(){return getMapStatistic(data[mapCode]);},[data,mapCode,getMapStatistic]);var statisticConfig=constants[\"w\" /* STATISTIC_CONFIGS */][statistic];var strokeColor=Object(react[\"useCallback\"])(function(alpha){return((statisticConfig===null||statisticConfig===void 0?void 0:statisticConfig.color)||'#343a40')+alpha;},[statisticConfig]);var features=Object(react[\"useMemo\"])(function(){if(!geoData)return null;var featuresWrap=!isDistrictView?Object(topojson_client_src[\"a\" /* feature */])(geoData,geoData.objects.states).features:mapMeta.mapType===constants[\"n\" /* MAP_TYPES */].COUNTRY&&mapViz!==constants[\"p\" /* MAP_VIZS */].CHOROPLETH?[].concat(Object(toConsumableArray[\"a\" /* default */])(Object(topojson_client_src[\"a\" /* feature */])(geoData,geoData.objects.states).features),Object(toConsumableArray[\"a\" /* default */])(Object(topojson_client_src[\"a\" /* feature */])(geoData,geoData.objects.districts).features)):Object(topojson_client_src[\"a\" /* feature */])(geoData,geoData.objects.districts).features;// Add id to each feature\nreturn featuresWrap.map(function(feature){var district=feature.properties.district;var state=feature.properties.st_nm;var obj=Object.assign({},feature);obj.id=\"\".concat(mapCode,\"-\").concat(state).concat(district?'-'+district:'');return obj;});},[geoData,mapCode,isDistrictView,mapViz,mapMeta]);var districtsSet=Object(react[\"useMemo\"])(function(){if(!geoData||!isDistrictView)return{};return Object(topojson_client_src[\"a\" /* feature */])(geoData,geoData.objects.districts).features.reduce(function(stateCodes,feature){var stateCode=constants[\"u\" /* STATE_CODES */][feature.properties.st_nm];if(!stateCodes[stateCode]){stateCodes[stateCode]=new Set();}stateCodes[stateCode].add(feature.properties.district);return stateCodes;},{});},[geoData,isDistrictView]);var statisticMax=Object(react[\"useMemo\"])(function(){var stateCodes=Object.keys(data).filter(function(stateCode){return stateCode!=='TT'&&Object.keys(constants[\"l\" /* MAP_META */]).includes(stateCode);});if(!isDistrictView){return Object(max[\"a\" /* default */])(stateCodes,function(stateCode){return transformStatistic(getMapStatistic(data[stateCode]));});}else{var districtData=stateCodes.reduce(function(res,stateCode){var _data$stateCode;var districts=Object.keys(((_data$stateCode=data[stateCode])===null||_data$stateCode===void 0?void 0:_data$stateCode.districts)||[]).filter(function(districtName){return((districtsSet===null||districtsSet===void 0?void 0:districtsSet[stateCode])||new Set()).has(districtName)||mapViz!==constants[\"p\" /* MAP_VIZS */].CHOROPLETH&&districtName===constants[\"z\" /* UNKNOWN_DISTRICT_KEY */];});res.push.apply(res,Object(toConsumableArray[\"a\" /* default */])(districts.map(function(districtName){return transformStatistic(getMapStatistic(data[stateCode].districts[districtName]));})));return res;},[]);return Object(max[\"a\" /* default */])(districtData);}},[data,isDistrictView,getMapStatistic,mapViz,districtsSet,transformStatistic]);var mapScale=Object(react[\"useMemo\"])(function(){var _STATISTIC_CONFIGS$st2,_STATISTIC_CONFIGS$st3;if(mapViz===constants[\"p\" /* MAP_VIZS */].BUBBLE){// No negative values\nreturn Object(pow[\"b\" /* sqrt */])([0,Math.max(1,statisticMax||0)],[0,40]).clamp(true).nice(3);}else if(mapViz===constants[\"p\" /* MAP_VIZS */].SPIKE){return Object(linear[\"a\" /* default */])([0,Math.max(1,statisticMax||0)],[0,80]).clamp(true).nice(3);}else if((_STATISTIC_CONFIGS$st2=constants[\"w\" /* STATISTIC_CONFIGS */][statistic])===null||_STATISTIC_CONFIGS$st2===void 0?void 0:(_STATISTIC_CONFIGS$st3=_STATISTIC_CONFIGS$st2.mapConfig)===null||_STATISTIC_CONFIGS$st3===void 0?void 0:_STATISTIC_CONFIGS$st3.colorScale){return constants[\"w\" /* STATISTIC_CONFIGS */][statistic].mapConfig.colorScale;}else{// No negative values\nreturn Object(sequential[\"a\" /* default */])([0,Math.max(1,statisticMax||0)],MapVisualizer_colorInterpolator(statistic)).clamp(true);}},[mapViz,statistic,statisticMax]);var fillColor=Object(react[\"useCallback\"])(function(d){if(mapViz===constants[\"p\" /* MAP_VIZS */].CHOROPLETH){var _stateData$districts;var stateCode=constants[\"u\" /* STATE_CODES */][d.properties.st_nm];var district=d.properties.district;var stateData=data[stateCode];var districtData=stateData===null||stateData===void 0?void 0:(_stateData$districts=stateData.districts)===null||_stateData$districts===void 0?void 0:_stateData$districts[district];var n=transformStatistic(getMapStatistic(district?districtData:stateData));var color=n?mapScale(n):'#ffffff00';return color;}},[mapViz,data,mapScale,getMapStatistic,transformStatistic]);var populateTexts=Object(react[\"useCallback\"])(function(regionSelection){regionSelection.select('title').text(function(d){if(mapViz!==constants[\"p\" /* MAP_VIZS */].CHOROPLETH&&!(statisticConfig===null||statisticConfig===void 0?void 0:statisticConfig.nonLinear)){var _stateData$districts2;var state=d.properties.st_nm;var stateCode=constants[\"u\" /* STATE_CODES */][state];var district=d.properties.district;var stateData=data[stateCode];var districtData=stateData===null||stateData===void 0?void 0:(_stateData$districts2=stateData.districts)===null||_stateData$districts2===void 0?void 0:_stateData$districts2[district];var n;if(district)n=getMapStatistic(districtData);else n=getMapStatistic(stateData);return\"\".concat(Object(commonFunctions[\"e\" /* formatNumber */])(100*(n/(statisticTotal||0.001)),'%'),\" from \").concat(Object(commonFunctions[\"m\" /* toTitleCase */])(district?district:state));}});},[mapViz,data,getMapStatistic,statisticTotal,statisticConfig]);var onceTouchedRegion=Object(react[\"useRef\"])(null);// Reset on tapping outside map\nObject(react[\"useEffect\"])(function(){var svg=Object(src_select[\"a\" /* default */])(svgRef.current);svg.attr('pointer-events','auto').on('click',function(){onceTouchedRegion.current=null;setRegionHighlighted({stateCode:mapCode,districtName:null});});},[mapCode,setRegionHighlighted]);var path=Object(react[\"useMemo\"])(function(){if(!geoData)return null;return Object(src_path[\"a\" /* default */])(Object(identity[\"a\" /* default */])());},[geoData]);// Choropleth\nObject(react[\"useEffect\"])(function(){if(!geoData)return;var svg=Object(src_select[\"a\" /* default */])(svgRef.current);var T=Object(src[\"a\" /* transition */])().duration(constants[\"c\" /* D3_TRANSITION_DURATION */]);svg.select('.regions').selectAll('path').data(mapViz===constants[\"p\" /* MAP_VIZS */].CHOROPLETH?features:[],function(d){return d.id;}).join(function(enter){return enter.append('path').attr('d',path).attr('stroke-width',1.8).attr('stroke-opacity',0).style('cursor','pointer').on('mouseenter',function(event,d){if(onceTouchedRegion.current)return;setRegionHighlighted({stateCode:constants[\"u\" /* STATE_CODES */][d.properties.st_nm],districtName:d.properties.district});}).on('pointerdown',function(event,d){if(onceTouchedRegion.current===d)onceTouchedRegion.current=null;else onceTouchedRegion.current=d;setRegionHighlighted({stateCode:constants[\"u\" /* STATE_CODES */][d.properties.st_nm],districtName:d.properties.district});}).attr('fill','#fff0').attr('stroke','#fff0');},function(update){return update;},function(exit){return exit.transition(T).attr('stroke','#fff0').attr('fill','#fff0').remove();}).attr('pointer-events','all').on('click',function(event,d){var _data$stateCode2;event.stopPropagation();var stateCode=constants[\"u\" /* STATE_CODES */][d.properties.st_nm];if(onceTouchedRegion.current||mapMeta.mapType===constants[\"n\" /* MAP_TYPES */].STATE||!((_data$stateCode2=data[stateCode])===null||_data$stateCode2===void 0?void 0:_data$stateCode2.districts))return;// Disable pointer events till the new map is rendered\nsvg.attr('pointer-events','none');svg.select('.regions').selectAll('path').attr('pointer-events','none');// Switch map\nhistory.push(\"/state/\".concat(stateCode).concat(window.innerWidth<769?'#MapExplorer':''));}).call(function(sel){sel.transition(T).attr('fill',fillColor).attr('stroke',strokeColor.bind(_this,''));});},[mapViz,data,features,fillColor,geoData,history,mapMeta.mapType,path,setRegionHighlighted,strokeColor]);var sortedFeatures=Object(react[\"useMemo\"])(function(){if(mapViz===constants[\"p\" /* MAP_VIZS */].CHOROPLETH){return[];}else{return(features||[]).map(function(feature){var stateCode=constants[\"u\" /* STATE_CODES */][feature.properties.st_nm];var districtName=feature.properties.district;var stateData=data[stateCode];if(!isDistrictView){feature.value=getMapStatistic(stateData);}else{var _stateData$districts3,_stateData$districts4;var districtData=stateData===null||stateData===void 0?void 0:(_stateData$districts3=stateData.districts)===null||_stateData$districts3===void 0?void 0:_stateData$districts3[districtName];if(districtName)feature.value=getMapStatistic(districtData);else feature.value=getMapStatistic(stateData===null||stateData===void 0?void 0:(_stateData$districts4=stateData.districts)===null||_stateData$districts4===void 0?void 0:_stateData$districts4[constants[\"z\" /* UNKNOWN_DISTRICT_KEY */]]);}return feature;}).filter(function(feature){return feature.value>0;}).sort(function(featureA,featureB){return featureB.value-featureB.value;});}},[mapViz,isDistrictView,getMapStatistic,features,data]);// Bubble\nObject(react[\"useEffect\"])(function(){var svg=Object(src_select[\"a\" /* default */])(svgRef.current);var T=Object(src[\"a\" /* transition */])().duration(constants[\"c\" /* D3_TRANSITION_DURATION */]);var regionSelection=svg.select('.circles').selectAll('circle').data(mapViz===constants[\"p\" /* MAP_VIZS */].BUBBLE?sortedFeatures:[],function(feature){return feature.id;}).join(function(enter){return enter.append('circle').attr('transform',function(feature){return\"translate(\".concat(path.centroid(feature),\")\");}).attr('fill-opacity',0.25).style('cursor','pointer').attr('pointer-events','all').call(function(enter){enter.append('title');});},function(update){return update;},function(exit){return exit.call(function(exit){return exit.transition(T).attr('r',0).remove();});}).on('mouseenter',function(event,feature){if(onceTouchedRegion.current)return;setRegionHighlighted({stateCode:constants[\"u\" /* STATE_CODES */][feature.properties.st_nm],districtName:!isDistrictView?null:feature.properties.district||constants[\"z\" /* UNKNOWN_DISTRICT_KEY */]});}).on('pointerdown',function(event,feature){if(onceTouchedRegion.current===feature)onceTouchedRegion.current=null;else onceTouchedRegion.current=feature;setRegionHighlighted({stateCode:constants[\"u\" /* STATE_CODES */][feature.properties.st_nm],districtName:!isDistrictView?null:feature.properties.district||constants[\"z\" /* UNKNOWN_DISTRICT_KEY */]});}).on('click',function(event,feature){event.stopPropagation();if(onceTouchedRegion.current||mapMeta.mapType===constants[\"n\" /* MAP_TYPES */].STATE)return;history.push(\"/state/\".concat(constants[\"u\" /* STATE_CODES */][feature.properties.st_nm]).concat(window.innerWidth<769?'#MapExplorer':''));}).call(function(sel){sel.transition(T).attr('fill',statisticConfig.color+'70').attr('stroke',statisticConfig.color+'70').attr('r',function(feature){return mapScale(feature.value);});});window.requestIdleCallback(function(){populateTexts(regionSelection);});},[mapMeta.mapType,mapViz,isDistrictView,sortedFeatures,history,mapScale,path,setRegionHighlighted,populateTexts,statisticConfig,getMapStatistic]);// Spike (Note: bad unmodular code)\nObject(react[\"useEffect\"])(function(){var svg=Object(src_select[\"a\" /* default */])(svgRef.current);var T=Object(src[\"a\" /* transition */])().duration(constants[\"c\" /* D3_TRANSITION_DURATION */]);var regionSelection=svg.select('.spikes').selectAll('path').data(mapViz===constants[\"p\" /* MAP_VIZS */].SPIKE?sortedFeatures:[],function(feature){return feature.id;},function(feature){return feature.id;}).join(function(enter){return enter.append('path').attr('transform',function(feature){return\"translate(\".concat(path.centroid(feature),\")\");}).attr('opacity',0).attr('fill-opacity',0.25).style('cursor','pointer').attr('pointer-events','all').attr('d',Object(commonFunctions[\"l\" /* spike */])(0)).call(function(enter){enter.append('title');});},function(update){return update;},function(exit){return exit.call(function(exit){return exit.transition(T).attr('opacity',0).attr('d',Object(commonFunctions[\"l\" /* spike */])(0)).remove();});}).on('mouseenter',function(event,feature){if(onceTouchedRegion.current)return;setRegionHighlighted({stateCode:constants[\"u\" /* STATE_CODES */][feature.properties.st_nm],districtName:!isDistrictView?null:feature.properties.district||constants[\"z\" /* UNKNOWN_DISTRICT_KEY */]});}).on('pointerdown',function(event,feature){if(onceTouchedRegion.current===feature)onceTouchedRegion.current=null;else onceTouchedRegion.current=feature;setRegionHighlighted({stateCode:constants[\"u\" /* STATE_CODES */][feature.properties.st_nm],districtName:!isDistrictView?null:feature.properties.district||constants[\"z\" /* UNKNOWN_DISTRICT_KEY */]});}).on('click',function(event,feature){event.stopPropagation();if(onceTouchedRegion.current||mapMeta.mapType===constants[\"n\" /* MAP_TYPES */].STATE)return;history.push(\"/state/\".concat(constants[\"u\" /* STATE_CODES */][feature.properties.st_nm]).concat(window.innerWidth<769?'#MapExplorer':''));}).call(function(sel){sel.transition(T).attr('opacity',1).attr('fill',statisticConfig.color+'70').attr('stroke',statisticConfig.color+'70').attr('d',function(feature){return Object(commonFunctions[\"l\" /* spike */])(mapScale(feature.value));});});window.requestIdleCallback(function(){populateTexts(regionSelection);});},[mapMeta.mapType,mapViz,isDistrictView,sortedFeatures,history,mapScale,path,setRegionHighlighted,populateTexts,statisticConfig,getMapStatistic]);// Boundaries\nObject(react[\"useEffect\"])(function(){if(!geoData)return;var svg=Object(src_select[\"a\" /* default */])(svgRef.current);var T=Object(src[\"a\" /* transition */])().duration(constants[\"c\" /* D3_TRANSITION_DURATION */]);var meshStates=[];var meshDistricts=[];if(mapMeta.mapType===constants[\"n\" /* MAP_TYPES */].COUNTRY){meshStates=[Object(topojson_client_src[\"b\" /* mesh */])(geoData,geoData.objects.states)];meshStates[0].id=\"\".concat(mapCode,\"-states\");}if(mapMeta.mapType===constants[\"n\" /* MAP_TYPES */].STATE||isDistrictView&&mapViz===constants[\"p\" /* MAP_VIZS */].CHOROPLETH){// Add id to mesh\nmeshDistricts=[Object(topojson_client_src[\"b\" /* mesh */])(geoData,geoData.objects.districts)];meshDistricts[0].id=\"\".concat(mapCode,\"-districts\");}svg.select('.state-borders').attr('fill','none').attr('stroke-width',1.5).selectAll('path').data(meshStates,function(d){return d.id;}).join(function(enter){return enter.append('path').attr('d',path).attr('stroke','#fff0');},function(update){return update;},function(exit){return exit.transition(T).attr('stroke','#fff0').remove();}).transition(T).attr('stroke',strokeColor.bind(_this,'40'));svg.select('.district-borders').attr('fill','none').attr('stroke-width',1.5).selectAll('path').data(meshDistricts,function(d){return d.id;}).join(function(enter){return enter.append('path').attr('d',path).attr('d',path).attr('stroke','#fff0');},function(update){return update;},function(exit){return exit.transition(T).attr('stroke','#fff0').remove();}).transition(T).attr('stroke',strokeColor.bind(_this,'40'));},[geoData,mapMeta,mapCode,mapViz,isDistrictView,statistic,path,strokeColor]);// Highlight\nObject(react[\"useEffect\"])(function(){var stateCode=regionHighlighted.stateCode;var stateName=constants[\"v\" /* STATE_NAMES */][stateCode];var district=regionHighlighted.districtName;var svg=Object(src_select[\"a\" /* default */])(svgRef.current);if(mapViz===constants[\"p\" /* MAP_VIZS */].BUBBLE){svg.select('.circles').selectAll('circle').attr('fill-opacity',function(d){var _d$properties;var highlighted=stateName===d.properties.st_nm&&(!district&&stateCode!==mapCode||district===((_d$properties=d.properties)===null||_d$properties===void 0?void 0:_d$properties.district)||!isDistrictView||district===constants[\"z\" /* UNKNOWN_DISTRICT_KEY */]&&!d.properties.district);return highlighted?1:0.25;});}else if(mapViz===constants[\"p\" /* MAP_VIZS */].SPIKE){svg.select('.spikes').selectAll('path').attr('fill-opacity',function(d){var _d$properties2;var highlighted=stateName===d.properties.st_nm&&(!district&&stateCode!==mapCode||district===((_d$properties2=d.properties)===null||_d$properties2===void 0?void 0:_d$properties2.district)||!isDistrictView||district===constants[\"z\" /* UNKNOWN_DISTRICT_KEY */]&&!d.properties.district);return highlighted?1:0.25;});}else{svg.select('.regions').selectAll('path').each(function(d){var _d$properties3;var highlighted=stateName===d.properties.st_nm&&(!district&&stateCode!==mapCode||district===((_d$properties3=d.properties)===null||_d$properties3===void 0?void 0:_d$properties3.district)||!isDistrictView);if(highlighted)this.parentNode.appendChild(this);Object(src_select[\"a\" /* default */])(this).attr('stroke-opacity',highlighted?1:0);});}},[geoData,data,mapCode,isDistrictView,mapViz,regionHighlighted.stateCode,regionHighlighted.districtName,statistic]);return/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(jsx_runtime[\"Fragment\"],{children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:\"svg-parent\",children:[/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"svg\",{id:\"chart\",className:classnames_default()({zone:!!(statisticConfig===null||statisticConfig===void 0?void 0:(_statisticConfig$mapC=statisticConfig.mapConfig)===null||_statisticConfig$mapC===void 0?void 0:_statisticConfig$mapC.colorScale)}),viewBox:\"0 0 \".concat(constants[\"j\" /* MAP_DIMENSIONS */][0],\" \").concat(constants[\"j\" /* MAP_DIMENSIONS */][1]),preserveAspectRatio:\"xMidYMid meet\",ref:svgRef,children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"g\",{className:\"regions\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"g\",{className:\"state-borders\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"g\",{className:\"district-borders\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"g\",{className:\"circles\"}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"g\",{className:\"spikes\"})]}),noDistrictData&&(statisticConfig===null||statisticConfig===void 0?void 0:statisticConfig.hasPrimary)&&/*#__PURE__*/Object(jsx_runtime[\"jsxs\"])(\"div\",{className:classnames_default()('disclaimer',\"is-\".concat(statistic)),children:[/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(index_esm[\"a\" /* AlertIcon */],{}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"span\",{children:t('District-wise data not available in state bulletin')})]})]}),mapScale&&/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(components_MapLegend,{data:data,statistic:statistic,mapViz:mapViz,mapScale:mapScale}),/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"svg\",{style:{position:'absolute',height:0},children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"defs\",{children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"filter\",{id:\"balance-color\",colorInterpolationFilters:\"sRGB\",children:/*#__PURE__*/Object(jsx_runtime[\"jsx\"])(\"feColorMatrix\",{type:\"matrix\",values:\"0.91372549  0           0            0  0.08627451 0           0.91372549  0            0  0.08627451 0           0           0.854901961  0  0.145098039 0           0           0            1  0\"})})})})]});}/* harmony default export */ var components_MapVisualizer = __webpack_exports__[\"default\"] = (MapVisualizer);\n\n/***/ })\n\n}]);","inputSourceMap":{"version":3,"sources":["/Users/nawaf/code/Create-a-D3-Dashboard-With-React-/src/components/MapLegend.js","/Users/nawaf/code/Create-a-D3-Dashboard-With-React-/src/components/MapVisualizer.js"],"names":["MapLegend","data","statistic","mapViz","mapScale","useTranslation","t","svgLegendRef","useRef","svgLegendChoroRef","useMeasure","wrapperRef","width","useEffect","transition","duration","D3_TRANSITION_DURATION","MAP_VIZS","CHOROPLETH","svg","select","current","attr","selectAll","remove","text","BUBBLE","SPIKES","call","g","spike","statisticConfig","STATISTIC_CONFIGS","zoom","MAP_DIMENSIONS","domain","domainMax","legend","legendRadius","map","d","join","color","yScale","copy","range","axisRight","tickSize","tickPadding","tickValues","tickFormat","num","formatNumber","format","style","SPIKE","ticks","slice","reverse","gap","enter","append","i","xScale","length","axisBottom","height","MAP_LEGEND_HEIGHT","n","mapConfig","colorScale","Number","isInteger","marginLeft","marginRight","position","title","marginTop","marginBottom","ordinalWeights","tickAdjust","x","interpolate","Math","min","rangeRound","quantize","ramp","toDataURL","interpolator","Object","assign","interpolateRound","undefined","round","quantile","invertExtent","thresholds","quantiles","thresholdFormat","scaleLinear","scaleBand","filter","max","bandwidth","widthScale","reduce","a","b","xPos","w","acc","scaleOrdinal","on","node","canvas","context","getContext","fillStyle","fillRect","colorInterpolator","interpolateReds","interpolateBlues","interpolateGreens","interpolateGreys","interpolatePurples","interpolateOranges","category","interpolatePiYG","MapVisualizer","mapCode","isDistrictView","regionHighlighted","setRegionHighlighted","getMapStatistic","transformStatistic","noDistrictData","svgRef","mapMeta","MAP_META","history","useHistory","useSWR","geoDataFile","file","json","console","log","suspense","revalidateOnFocus","geoData","statisticTotal","useMemo","strokeColor","useCallback","alpha","features","featuresWrap","feature","objects","states","mapType","MAP_TYPES","COUNTRY","districts","district","properties","state","st_nm","obj","id","districtsSet","stateCodes","stateCode","STATE_CODES","Set","add","statisticMax","keys","includes","districtData","res","districtName","has","UNKNOWN_DISTRICT_KEY","push","scaleSqrt","clamp","nice","scaleSequential","fillColor","stateData","populateTexts","regionSelection","nonLinear","toTitleCase","onceTouchedRegion","path","geoPath","geoIdentity","T","event","update","exit","stopPropagation","STATE","window","innerWidth","sel","bind","sortedFeatures","value","sort","featureA","featureB","centroid","requestIdleCallback","meshStates","meshDistricts","mesh","stateName","STATE_NAMES","highlighted","each","parentNode","appendChild","classnames","zone","hasPrimary"],"mappings":"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","file":"x","sourcesContent":["import {\n  D3_TRANSITION_DURATION,\n  MAP_DIMENSIONS,\n  MAP_LEGEND_HEIGHT,\n  MAP_VIZS,\n  STATISTIC_CONFIGS,\n} from '../constants';\nimport {formatNumber, spike} from '../utils/commonFunctions';\n\nimport {range, quantile} from 'd3-array';\nimport {axisRight, axisBottom} from 'd3-axis';\nimport {format} from 'd3-format';\nimport {interpolate, interpolateRound, quantize} from 'd3-interpolate';\nimport {scaleLinear, scaleOrdinal, scaleBand} from 'd3-scale';\nimport {select} from 'd3-selection';\nimport {transition} from 'd3-transition';\nimport {useEffect, useRef} from 'react';\nimport {useTranslation} from 'react-i18next';\nimport {useMeasure} from 'react-use';\n\nfunction MapLegend({data, statistic, mapViz, mapScale}) {\n  const {t} = useTranslation();\n  const svgLegendRef = useRef(null);\n  const svgLegendChoroRef = useRef(null);\n  const [wrapperRef, {width}] = useMeasure();\n\n  useEffect(() => {\n    const t = transition().duration(D3_TRANSITION_DURATION);\n\n    if (mapViz !== MAP_VIZS.CHOROPLETH) {\n      const svg = select(svgLegendChoroRef.current);\n      svg\n        .select('.ramp')\n        .transition(t)\n        .attr('opacity', 0)\n        .attr('display', 'none')\n        .attr('xlink:href', null);\n\n      svg\n        .select('.bars')\n        .selectAll('rect')\n        .transition(t)\n        .attr('opacity', 0)\n        .remove();\n      svg.selectAll('.axis > *:not(.axistext)').remove();\n      svg.select('.axistext').text('');\n    }\n\n    if (mapViz !== MAP_VIZS.BUBBLE) {\n      const svg = select(svgLegendRef.current);\n      svg\n        .select('.circles')\n        .selectAll('circle')\n        .transition(t)\n        .attr('r', 0)\n        .attr('cy', 0)\n        .remove();\n      svg.selectAll('.circle-axis > *').remove();\n    }\n\n    if (mapViz !== MAP_VIZS.SPIKES) {\n      const svg = select(svgLegendRef.current);\n      svg\n        .select('.spikes')\n        .call((g) =>\n          g.selectAll('path').transition(t).attr('d', spike(0)).remove()\n        )\n        .call((g) => g.selectAll('text').remove())\n        .transition(t)\n        .selectAll('g')\n        .remove();\n      svg.selectAll('.spike-axis > *').remove();\n    }\n  }, [mapViz]);\n\n  useEffect(() => {\n    if (!width) return;\n\n    const statisticConfig = STATISTIC_CONFIGS[statistic];\n    const zoom = width / MAP_DIMENSIONS[0];\n\n    if (mapViz === MAP_VIZS.BUBBLE) {\n      const svg = select(svgLegendRef.current);\n\n      const [, domainMax] = mapScale.domain();\n\n      const legend = svg\n        .select('.circles')\n        .attr('transform', `translate(48,40)`)\n        .attr('text-anchor', 'middle');\n\n      const legendRadius = [0.1, 0.4, 1].map((d) => d * domainMax);\n\n      legend\n        .selectAll('circle')\n        .data(legendRadius)\n        .join('circle')\n        .attr('fill', 'none')\n        .attr('stroke', statisticConfig.color + '70')\n        .transition(t)\n        .attr('cy', (d) => -mapScale(d))\n        .attr('r', (d) => mapScale(d));\n\n      const yScale = mapScale.copy().range([0, -2 * mapScale(domainMax)]);\n\n      svg\n        .select('.circle-axis')\n        .attr('transform', `translate(48,50)`)\n        .transition(t)\n        .call(\n          axisRight(yScale)\n            .tickSize(0)\n            .tickPadding(0)\n            .tickValues(legendRadius)\n            .tickFormat((num) =>\n              formatNumber(\n                num,\n                statisticConfig.format === 'long'\n                  ? 'short'\n                  : statisticConfig.format\n              )\n            )\n        )\n        .selectAll('.tick text')\n        .style('text-anchor', 'middle')\n        .attr('font-size', 10 / zoom);\n\n      svg.select('.circle-axis').call((g) => g.select('.domain').remove());\n    } else if (mapViz === MAP_VIZS.SPIKE) {\n      const svg = select(svgLegendRef.current);\n      const ticks = mapScale.ticks(3).slice(1).reverse();\n\n      const gap = 28 / zoom;\n\n      svg\n        .select('.spikes')\n        .attr('transform', `translate(32,24)`)\n        .selectAll('g')\n        .data(ticks)\n        .join((enter) =>\n          enter.append('g').call((g) =>\n            g\n              .append('path')\n              .attr('fill-opacity', 0.3)\n              .attr('d', (d) => spike(0))\n          )\n        )\n        .attr('transform', (d, i) => `translate(${i * gap},0)`)\n        .call((g) =>\n          g\n            .select('path')\n            .transition(t)\n            .attr('d', (d) => spike(mapScale(d)))\n            .attr('fill', statisticConfig.color + '70')\n            .attr('stroke', statisticConfig.color + '70')\n        );\n\n      const xScale = mapScale.copy().range([gap * ticks.length, 0]);\n      svg\n        .select('.spike-axis')\n        .attr('transform', `translate(32,32)`)\n        .transition(t)\n        .call(\n          axisBottom(xScale)\n            .tickSize(0)\n            .tickPadding(0)\n            .tickValues(ticks)\n            .tickFormat((num) =>\n              formatNumber(\n                num,\n                statisticConfig.format === 'long'\n                  ? 'short'\n                  : statisticConfig.format\n              )\n            )\n        )\n        .selectAll('.tick text')\n        .style('text-anchor', 'middle')\n        .attr('font-size', 10 / zoom);\n\n      svg.select('.spike-axis').call((g) => g.select('.domain').remove());\n    } else {\n      const svg = select(svgLegendChoroRef.current);\n      svg.call(() =>\n        legend({\n          svg: svg,\n          color: mapScale,\n          width: width,\n          height: MAP_LEGEND_HEIGHT,\n          ticks: 5,\n          tickFormat: function (d, i, n) {\n            if (statisticConfig?.mapConfig?.colorScale) {\n              return d;\n            } else if (mapViz === MAP_VIZS.CHOROPLETH && !Number.isInteger(d)) {\n              return '';\n            } else if (i === n.length - 1) {\n              return formatNumber(d, statisticConfig.format) + '+';\n            } else {\n              return formatNumber(d, statisticConfig.format);\n            }\n          },\n          marginLeft: 2,\n          marginRight: 0,\n        })\n      );\n      svg.attr('class', statisticConfig?.mapConfig?.colorScale ? 'zone' : '');\n    }\n  }, [t, width, statistic, mapScale, mapViz]);\n\n  return (\n    <div\n      className=\"svg-parent maplegend\"\n      ref={wrapperRef}\n      style={{height: 2 * MAP_LEGEND_HEIGHT}}\n    >\n      <svg\n        id=\"legend\"\n        preserveAspectRatio=\"xMinYMid meet\"\n        ref={svgLegendRef}\n        viewBox={`0 0 ${MAP_DIMENSIONS[0]} ${MAP_LEGEND_HEIGHT}`}\n      >\n        <g className=\"circles\"></g>\n        <g className=\"spikes\"></g>\n        <g className=\"circle-axis\"></g>\n        <g className=\"spike-axis\"></g>\n        <g className=\"axis\">\n          <text className=\"axistext\" />\n        </g>\n      </svg>\n      <svg\n        id=\"legend-choro\"\n        preserveAspectRatio=\"xMinYMid meet\"\n        ref={svgLegendChoroRef}\n      >\n        <image className=\"ramp\" preserveAspectRatio=\"none\" />\n        <g className=\"bars\"></g>\n        <g className=\"axis\">\n          <text className=\"axistext\" />\n        </g>\n      </svg>\n      <canvas\n        className=\"color-scale\"\n        style={{position: 'absolute', height: 0}}\n      />\n    </div>\n  );\n}\n\nexport default MapLegend;\n\nfunction legend({\n  svg,\n  color,\n  title,\n  tickSize = 6,\n  width = 320,\n  height = 44 + tickSize,\n  marginTop = 18,\n  marginRight = 0,\n  marginBottom = 16 + tickSize,\n  marginLeft = 0,\n  ticks = width / 64,\n  tickFormat,\n  tickValues,\n  ordinalWeights,\n} = {}) {\n  const t = svg.transition().duration(D3_TRANSITION_DURATION);\n\n  let tickAdjust = (g) => {\n    const ticks = g.selectAll('.tick line');\n    ticks.attr('y1', marginTop + marginBottom - height);\n    // select(ticks.nodes()[ticks.size() - 1]).remove();\n  };\n  let x;\n\n  // Continuous\n  if (color.interpolate) {\n    const n = Math.min(color.domain().length, color.range().length);\n\n    x = color\n      .copy()\n      .rangeRound(quantize(interpolate(marginLeft, width - marginRight), n));\n\n    svg\n      .select('.ramp')\n      .attr('x', marginLeft)\n      .attr('y', marginTop)\n      .attr('width', width - marginLeft - marginRight)\n      .attr('height', height - marginTop - marginBottom)\n      .attr(\n        'xlink:href',\n        ramp(color.copy().domain(quantize(interpolate(0, 1), n))).toDataURL()\n      );\n  }\n\n  // Sequential\n  else if (color.interpolator) {\n    svg\n      .select('.bars')\n      .selectAll('rect')\n      .transition(t)\n      .attr('opacity', 0)\n      .remove();\n\n    x = Object.assign(\n      color\n        .copy()\n        .interpolator(interpolateRound(marginLeft, width - marginRight)),\n      {\n        range() {\n          return [marginLeft, width - marginRight];\n        },\n      }\n    );\n\n    svg\n      .select('.ramp')\n      .attr('x', marginLeft)\n      .attr('y', marginTop)\n      .attr('width', width - marginLeft - marginRight)\n      .attr('height', height - marginTop - marginBottom)\n      .attr('xlink:href', ramp(color.interpolator()).toDataURL())\n      .attr('display', 'visible')\n      .transition(t)\n      .attr('opacity', 1);\n\n    // scaleSequentialQuantile doesnt implement ticks or tickFormat.\n    if (!x.ticks) {\n      if (tickValues === undefined) {\n        const n = Math.round(ticks + 1);\n        tickValues = range(n).map((i) => quantile(color.domain(), i / (n - 1)));\n      }\n      if (typeof tickFormat !== 'function') {\n        tickFormat = format(tickFormat === undefined ? ',f' : tickFormat);\n      }\n    }\n  }\n\n  // Threshold\n  else if (color.invertExtent) {\n    const thresholds = color.thresholds\n      ? color.thresholds() // scaleQuantize\n      : color.quantiles\n      ? color.quantiles() // scaleQuantile\n      : color.domain(); // scaleThreshold\n\n    const thresholdFormat =\n      tickFormat === undefined\n        ? (d) => d\n        : typeof tickFormat === 'string'\n        ? format(tickFormat)\n        : tickFormat;\n\n    x = scaleLinear()\n      .domain([-1, color.range().length - 1])\n      .rangeRound([marginLeft, width - marginRight]);\n\n    svg\n      .append('g')\n      .selectAll('rect')\n      .data(color.range())\n      .join('rect')\n      .attr('x', (d, i) => x(i - 1))\n      .attr('y', marginTop)\n      .attr('width', (d, i) => x(i) - x(i - 1))\n      .attr('height', height - marginTop - marginBottom)\n      .attr('fill', (d) => d);\n\n    tickValues = range(-1, thresholds.length);\n    tickFormat = (i) => {\n      if (i === -1) return thresholdFormat(1);\n      else if (i === thresholds.length - 1) return;\n      else if (i === thresholds.length - 2)\n        return thresholdFormat(thresholds[i] + '+', i);\n      return thresholdFormat(thresholds[i], i);\n    };\n  }\n\n  // Ordinal\n  else {\n    svg\n      .select('.ramp')\n      .transition(t)\n      .attr('opacity', 0)\n      .attr('xlink:href', null);\n    if (!ordinalWeights) {\n      x = scaleBand()\n        .domain(color.domain().filter((d) => d))\n        .rangeRound([marginLeft, width - marginRight]);\n      svg\n        .select('.bars')\n        .selectAll('rect')\n        .data(color.domain().filter((d) => d))\n        .join('rect')\n        .attr('x', x)\n        .attr('y', marginTop)\n        .attr('width', Math.max(0, x.bandwidth() - 1))\n        .attr('height', height - marginTop - marginBottom)\n        .attr('fill', color);\n    } else {\n      const widthScale = scaleLinear()\n        .domain([0, ordinalWeights.reduce((a, b) => a + b)])\n        .rangeRound([0, width - marginLeft - marginRight]);\n\n      const xPos = ordinalWeights.map((w, i) =>\n        ordinalWeights\n          .slice(0, i)\n          .reduce((acc, w) => acc + widthScale(w), marginLeft)\n      );\n\n      x = scaleOrdinal().domain(color.domain()).range(xPos);\n\n      svg\n        .select('.bars')\n        .selectAll('rect')\n        .data(color.domain())\n        .join((enter) =>\n          enter\n            .append('rect')\n            .attr('x', x)\n            .attr('width', (d, i) => widthScale(ordinalWeights[i]))\n        )\n        .attr('y', marginTop)\n        .attr('height', height - marginTop - marginBottom)\n        .attr('fill', color)\n        .transition(t)\n        .attr('x', x)\n        .attr('width', (d, i) => widthScale(ordinalWeights[i]))\n        .attr('opacity', 1);\n    }\n\n    tickAdjust = () => {};\n  }\n\n  svg\n    .select('.axis')\n    .attr('transform', `translate(0,${height - marginBottom})`)\n    .transition(t)\n    .attr('class', 'axis')\n    .call(\n      axisBottom(x)\n        .ticks(ticks, typeof tickFormat === 'string' ? tickFormat : undefined)\n        .tickFormat(typeof tickFormat === 'function' ? tickFormat : undefined)\n        .tickSize(tickSize)\n        .tickValues(tickValues)\n    )\n    .on('start', () => {\n      svg.call(tickAdjust).call((svg) => svg.select('.domain').remove());\n    })\n    .call((g) =>\n      g\n        .select('.axistext')\n        .attr('class', 'axistext')\n        .attr('x', marginLeft)\n        .attr('y', marginTop + marginBottom - height - 6)\n        .attr('fill', 'currentColor')\n        .attr('text-anchor', 'start')\n        .attr('font-weight', 'bold')\n        .text(title)\n    );\n\n  return svg.node();\n}\n\nfunction ramp(color, n = 256) {\n  const canvas = select('.color-scale').node();\n  const context = ((canvas.width = n), (canvas.height = 1), canvas).getContext(\n    '2d'\n  );\n  for (let i = 0; i < n; ++i) {\n    context.fillStyle = color(i / (n - 1));\n    context.fillRect(i, 0, 1, 1);\n  }\n  return canvas;\n}\n","import MapLegend from './MapLegend';\n\nimport {\n  D3_TRANSITION_DURATION,\n  MAP_DIMENSIONS,\n  MAP_META,\n  MAP_TYPES,\n  MAP_VIZS,\n  STATE_CODES,\n  STATE_NAMES,\n  STATISTIC_CONFIGS,\n  UNKNOWN_DISTRICT_KEY,\n} from '../constants';\nimport {formatNumber, spike, toTitleCase} from '../utils/commonFunctions';\n\nimport {AlertIcon} from '@primer/octicons-react';\nimport classnames from 'classnames';\nimport {max} from 'd3-array';\nimport {json} from 'd3-fetch';\nimport {geoIdentity, geoPath} from 'd3-geo';\nimport {scaleLinear, scaleSqrt, scaleSequential} from 'd3-scale';\nimport {\n  interpolateReds,\n  interpolateBlues,\n  interpolateGreens,\n  interpolateGreys,\n  interpolatePurples,\n  interpolateOranges,\n  interpolatePiYG,\n} from 'd3-scale-chromatic';\nimport {select} from 'd3-selection';\nimport {transition} from 'd3-transition';\nimport {useCallback, useEffect, useMemo, useRef} from 'react';\nimport {useTranslation} from 'react-i18next';\nimport {useHistory} from 'react-router-dom';\nimport useSWR from 'swr';\nimport {feature, mesh} from 'topojson-client';\n\nconst colorInterpolator = (statistic) => {\n  if (statistic === 'confirmed') {\n    return (t) => interpolateReds(t * 0.85);\n  } else if (statistic === 'active') {\n    return (t) => interpolateBlues(t * 0.85);\n  } else if (statistic === 'recovered') {\n    return (t) => interpolateGreens(t * 0.85);\n  } else if (statistic === 'deceased') {\n    return (t) => interpolateGreys(t * 0.85);\n  } else if (statistic === 'tested') {\n    return (t) => interpolatePurples(t * 0.85);\n  } else if (\n    statistic === 'tpr' ||\n    statistic === 'cfr' ||\n    statistic === 'other'\n  ) {\n    return (t) => interpolateOranges(t * 0.85);\n  } else if (STATISTIC_CONFIGS[statistic]?.category === 'vaccinated') {\n    return (t) => interpolatePiYG(0.15 + 0.35 * (1 - t));\n  } else {\n    return (t) => interpolateOranges(t * 0.85);\n  }\n};\n\nfunction MapVisualizer({\n  mapCode,\n  isDistrictView,\n  mapViz,\n  data,\n  regionHighlighted,\n  setRegionHighlighted,\n  statistic,\n  getMapStatistic,\n  transformStatistic,\n  noDistrictData,\n}) {\n  const {t} = useTranslation();\n  const svgRef = useRef(null);\n\n  const mapMeta = MAP_META[mapCode];\n  const history = useHistory();\n\n  const {data: geoData} = useSWR(\n    mapMeta.geoDataFile,\n    async (file) => {\n      const x = await json(file);\n      console.log(x)\n      return x;\n    },\n    {suspense: false, revalidateOnFocus: false}\n  );\n\n  const statisticTotal = useMemo(() => {\n    return getMapStatistic(data[mapCode]);\n  }, [data, mapCode, getMapStatistic]);\n\n  const statisticConfig = STATISTIC_CONFIGS[statistic];\n\n  const strokeColor = useCallback(\n    (alpha) => (statisticConfig?.color || '#343a40') + alpha,\n    [statisticConfig]\n  );\n\n  const features = useMemo(() => {\n    if (!geoData) return null;\n\n    const featuresWrap = !isDistrictView\n      ? feature(geoData, geoData.objects.states).features\n      : mapMeta.mapType === MAP_TYPES.COUNTRY && mapViz !== MAP_VIZS.CHOROPLETH\n      ? [\n          ...feature(geoData, geoData.objects.states).features,\n          ...feature(geoData, geoData.objects.districts).features,\n        ]\n      : feature(geoData, geoData.objects.districts).features;\n    // Add id to each feature\n    return featuresWrap.map((feature) => {\n      const district = feature.properties.district;\n      const state = feature.properties.st_nm;\n      const obj = Object.assign({}, feature);\n      obj.id = `${mapCode}-${state}${district ? '-' + district : ''}`;\n      return obj;\n    });\n  }, [geoData, mapCode, isDistrictView, mapViz, mapMeta]);\n\n  const districtsSet = useMemo(() => {\n    if (!geoData || !isDistrictView) return {};\n    return feature(geoData, geoData.objects.districts).features.reduce(\n      (stateCodes, feature) => {\n        const stateCode = STATE_CODES[feature.properties.st_nm];\n        if (!stateCodes[stateCode]) {\n          stateCodes[stateCode] = new Set();\n        }\n        stateCodes[stateCode].add(feature.properties.district);\n        return stateCodes;\n      },\n      {}\n    );\n  }, [geoData, isDistrictView]);\n\n  const statisticMax = useMemo(() => {\n    const stateCodes = Object.keys(data).filter(\n      (stateCode) =>\n        stateCode !== 'TT' && Object.keys(MAP_META).includes(stateCode)\n    );\n\n    if (!isDistrictView) {\n      return max(stateCodes, (stateCode) =>\n        transformStatistic(getMapStatistic(data[stateCode]))\n      );\n    } else {\n      const districtData = stateCodes.reduce((res, stateCode) => {\n        const districts = Object.keys(data[stateCode]?.districts || []).filter(\n          (districtName) =>\n            (districtsSet?.[stateCode] || new Set()).has(districtName) ||\n            (mapViz !== MAP_VIZS.CHOROPLETH &&\n              districtName === UNKNOWN_DISTRICT_KEY)\n        );\n        res.push(\n          ...districts.map((districtName) =>\n            transformStatistic(\n              getMapStatistic(data[stateCode].districts[districtName])\n            )\n          )\n        );\n        return res;\n      }, []);\n      return max(districtData);\n    }\n  }, [\n    data,\n    isDistrictView,\n    getMapStatistic,\n    mapViz,\n    districtsSet,\n    transformStatistic,\n  ]);\n\n  const mapScale = useMemo(() => {\n    if (mapViz === MAP_VIZS.BUBBLE) {\n      // No negative values\n      return scaleSqrt([0, Math.max(1, statisticMax || 0)], [0, 40])\n        .clamp(true)\n        .nice(3);\n    } else if (mapViz === MAP_VIZS.SPIKE) {\n      return scaleLinear([0, Math.max(1, statisticMax || 0)], [0, 80])\n        .clamp(true)\n        .nice(3);\n    } else if (STATISTIC_CONFIGS[statistic]?.mapConfig?.colorScale) {\n      return STATISTIC_CONFIGS[statistic].mapConfig.colorScale;\n    } else {\n      // No negative values\n      return scaleSequential(\n        [0, Math.max(1, statisticMax || 0)],\n        colorInterpolator(statistic)\n      ).clamp(true);\n    }\n  }, [mapViz, statistic, statisticMax]);\n\n  const fillColor = useCallback(\n    (d) => {\n      if (mapViz === MAP_VIZS.CHOROPLETH) {\n        const stateCode = STATE_CODES[d.properties.st_nm];\n        const district = d.properties.district;\n        const stateData = data[stateCode];\n        const districtData = stateData?.districts?.[district];\n        const n = transformStatistic(\n          getMapStatistic(district ? districtData : stateData)\n        );\n        const color = n ? mapScale(n) : '#ffffff00';\n        return color;\n      }\n    },\n    [mapViz, data, mapScale, getMapStatistic, transformStatistic]\n  );\n\n  const populateTexts = useCallback(\n    (regionSelection) => {\n      regionSelection.select('title').text((d) => {\n        if (mapViz !== MAP_VIZS.CHOROPLETH && !statisticConfig?.nonLinear) {\n          const state = d.properties.st_nm;\n          const stateCode = STATE_CODES[state];\n          const district = d.properties.district;\n\n          const stateData = data[stateCode];\n          const districtData = stateData?.districts?.[district];\n          let n;\n          if (district) n = getMapStatistic(districtData);\n          else n = getMapStatistic(stateData);\n          return `${formatNumber(\n            100 * (n / (statisticTotal || 0.001)),\n            '%'\n          )} from ${toTitleCase(district ? district : state)}`;\n        }\n      });\n    },\n    [mapViz, data, getMapStatistic, statisticTotal, statisticConfig]\n  );\n\n  const onceTouchedRegion = useRef(null);\n\n  // Reset on tapping outside map\n  useEffect(() => {\n    const svg = select(svgRef.current);\n\n    svg.attr('pointer-events', 'auto').on('click', () => {\n      onceTouchedRegion.current = null;\n      setRegionHighlighted({\n        stateCode: mapCode,\n        districtName: null,\n      });\n    });\n  }, [mapCode, setRegionHighlighted]);\n\n  const path = useMemo(() => {\n    if (!geoData) return null;\n    return geoPath(geoIdentity());\n  }, [geoData]);\n\n  // Choropleth\n  useEffect(() => {\n    if (!geoData) return;\n    const svg = select(svgRef.current);\n    const T = transition().duration(D3_TRANSITION_DURATION);\n\n    svg\n      .select('.regions')\n      .selectAll('path')\n      .data(mapViz === MAP_VIZS.CHOROPLETH ? features : [], (d) => d.id)\n      .join(\n        (enter) =>\n          enter\n            .append('path')\n            .attr('d', path)\n            .attr('stroke-width', 1.8)\n            .attr('stroke-opacity', 0)\n            .style('cursor', 'pointer')\n            .on('mouseenter', (event, d) => {\n              if (onceTouchedRegion.current) return;\n              setRegionHighlighted({\n                stateCode: STATE_CODES[d.properties.st_nm],\n                districtName: d.properties.district,\n              });\n            })\n            .on('pointerdown', (event, d) => {\n              if (onceTouchedRegion.current === d)\n                onceTouchedRegion.current = null;\n              else onceTouchedRegion.current = d;\n              setRegionHighlighted({\n                stateCode: STATE_CODES[d.properties.st_nm],\n                districtName: d.properties.district,\n              });\n            })\n            .attr('fill', '#fff0')\n            .attr('stroke', '#fff0'),\n        (update) => update,\n        (exit) =>\n          exit\n            .transition(T)\n            .attr('stroke', '#fff0')\n            .attr('fill', '#fff0')\n            .remove()\n      )\n      .attr('pointer-events', 'all')\n      .on('click', (event, d) => {\n        event.stopPropagation();\n        const stateCode = STATE_CODES[d.properties.st_nm];\n        if (\n          onceTouchedRegion.current ||\n          mapMeta.mapType === MAP_TYPES.STATE ||\n          !data[stateCode]?.districts\n        )\n          return;\n        // Disable pointer events till the new map is rendered\n        svg.attr('pointer-events', 'none');\n        svg.select('.regions').selectAll('path').attr('pointer-events', 'none');\n        // Switch map\n        history.push(\n          `/state/${stateCode}${window.innerWidth < 769 ? '#MapExplorer' : ''}`\n        );\n      })\n      .call((sel) => {\n        sel\n          .transition(T)\n          .attr('fill', fillColor)\n          .attr('stroke', strokeColor.bind(this, ''));\n      });\n  }, [\n    mapViz,\n    data,\n    features,\n    fillColor,\n    geoData,\n    history,\n    mapMeta.mapType,\n    path,\n    setRegionHighlighted,\n    strokeColor,\n  ]);\n\n  const sortedFeatures = useMemo(() => {\n    if (mapViz === MAP_VIZS.CHOROPLETH) {\n      return [];\n    } else {\n      return (features || [])\n        .map((feature) => {\n          const stateCode = STATE_CODES[feature.properties.st_nm];\n          const districtName = feature.properties.district;\n          const stateData = data[stateCode];\n\n          if (!isDistrictView) {\n            feature.value = getMapStatistic(stateData);\n          } else {\n            const districtData = stateData?.districts?.[districtName];\n\n            if (districtName) feature.value = getMapStatistic(districtData);\n            else\n              feature.value = getMapStatistic(\n                stateData?.districts?.[UNKNOWN_DISTRICT_KEY]\n              );\n          }\n\n          return feature;\n        })\n        .filter((feature) => feature.value > 0)\n        .sort((featureA, featureB) => featureB.value - featureB.value);\n    }\n  }, [mapViz, isDistrictView, getMapStatistic, features, data]);\n\n  // Bubble\n  useEffect(() => {\n    const svg = select(svgRef.current);\n    const T = transition().duration(D3_TRANSITION_DURATION);\n\n    const regionSelection = svg\n      .select('.circles')\n      .selectAll('circle')\n      .data(\n        mapViz === MAP_VIZS.BUBBLE ? sortedFeatures : [],\n        (feature) => feature.id\n      )\n      .join(\n        (enter) =>\n          enter\n            .append('circle')\n            .attr(\n              'transform',\n              (feature) => `translate(${path.centroid(feature)})`\n            )\n            .attr('fill-opacity', 0.25)\n            .style('cursor', 'pointer')\n            .attr('pointer-events', 'all')\n            .call((enter) => {\n              enter.append('title');\n            }),\n        (update) => update,\n        (exit) => exit.call((exit) => exit.transition(T).attr('r', 0).remove())\n      )\n      .on('mouseenter', (event, feature) => {\n        if (onceTouchedRegion.current) return;\n        setRegionHighlighted({\n          stateCode: STATE_CODES[feature.properties.st_nm],\n          districtName: !isDistrictView\n            ? null\n            : feature.properties.district || UNKNOWN_DISTRICT_KEY,\n        });\n      })\n      .on('pointerdown', (event, feature) => {\n        if (onceTouchedRegion.current === feature)\n          onceTouchedRegion.current = null;\n        else onceTouchedRegion.current = feature;\n        setRegionHighlighted({\n          stateCode: STATE_CODES[feature.properties.st_nm],\n          districtName: !isDistrictView\n            ? null\n            : feature.properties.district || UNKNOWN_DISTRICT_KEY,\n        });\n      })\n      .on('click', (event, feature) => {\n        event.stopPropagation();\n        if (onceTouchedRegion.current || mapMeta.mapType === MAP_TYPES.STATE)\n          return;\n        history.push(\n          `/state/${STATE_CODES[feature.properties.st_nm]}${\n            window.innerWidth < 769 ? '#MapExplorer' : ''\n          }`\n        );\n      })\n      .call((sel) => {\n        sel\n          .transition(T)\n          .attr('fill', statisticConfig.color + '70')\n          .attr('stroke', statisticConfig.color + '70')\n          .attr('r', (feature) => mapScale(feature.value));\n      });\n\n    window.requestIdleCallback(() => {\n      populateTexts(regionSelection);\n    });\n  }, [\n    mapMeta.mapType,\n    mapViz,\n    isDistrictView,\n    sortedFeatures,\n    history,\n    mapScale,\n    path,\n    setRegionHighlighted,\n    populateTexts,\n    statisticConfig,\n    getMapStatistic,\n  ]);\n\n  // Spike (Note: bad unmodular code)\n  useEffect(() => {\n    const svg = select(svgRef.current);\n    const T = transition().duration(D3_TRANSITION_DURATION);\n\n    const regionSelection = svg\n      .select('.spikes')\n      .selectAll('path')\n      .data(\n        mapViz === MAP_VIZS.SPIKE ? sortedFeatures : [],\n        (feature) => feature.id,\n        (feature) => feature.id\n      )\n      .join(\n        (enter) =>\n          enter\n            .append('path')\n            .attr(\n              'transform',\n              (feature) => `translate(${path.centroid(feature)})`\n            )\n            .attr('opacity', 0)\n            .attr('fill-opacity', 0.25)\n            .style('cursor', 'pointer')\n            .attr('pointer-events', 'all')\n            .attr('d', spike(0))\n            .call((enter) => {\n              enter.append('title');\n            }),\n        (update) => update,\n        (exit) =>\n          exit.call((exit) =>\n            exit.transition(T).attr('opacity', 0).attr('d', spike(0)).remove()\n          )\n      )\n      .on('mouseenter', (event, feature) => {\n        if (onceTouchedRegion.current) return;\n        setRegionHighlighted({\n          stateCode: STATE_CODES[feature.properties.st_nm],\n          districtName: !isDistrictView\n            ? null\n            : feature.properties.district || UNKNOWN_DISTRICT_KEY,\n        });\n      })\n      .on('pointerdown', (event, feature) => {\n        if (onceTouchedRegion.current === feature)\n          onceTouchedRegion.current = null;\n        else onceTouchedRegion.current = feature;\n        setRegionHighlighted({\n          stateCode: STATE_CODES[feature.properties.st_nm],\n          districtName: !isDistrictView\n            ? null\n            : feature.properties.district || UNKNOWN_DISTRICT_KEY,\n        });\n      })\n      .on('click', (event, feature) => {\n        event.stopPropagation();\n        if (onceTouchedRegion.current || mapMeta.mapType === MAP_TYPES.STATE)\n          return;\n        history.push(\n          `/state/${STATE_CODES[feature.properties.st_nm]}${\n            window.innerWidth < 769 ? '#MapExplorer' : ''\n          }`\n        );\n      })\n      .call((sel) => {\n        sel\n          .transition(T)\n          .attr('opacity', 1)\n          .attr('fill', statisticConfig.color + '70')\n          .attr('stroke', statisticConfig.color + '70')\n          .attr('d', (feature) => spike(mapScale(feature.value)));\n      });\n\n    window.requestIdleCallback(() => {\n      populateTexts(regionSelection);\n    });\n  }, [\n    mapMeta.mapType,\n    mapViz,\n    isDistrictView,\n    sortedFeatures,\n    history,\n    mapScale,\n    path,\n    setRegionHighlighted,\n    populateTexts,\n    statisticConfig,\n    getMapStatistic,\n  ]);\n\n  // Boundaries\n  useEffect(() => {\n    if (!geoData) return;\n    const svg = select(svgRef.current);\n    const T = transition().duration(D3_TRANSITION_DURATION);\n\n    let meshStates = [];\n    let meshDistricts = [];\n\n    if (mapMeta.mapType === MAP_TYPES.COUNTRY) {\n      meshStates = [mesh(geoData, geoData.objects.states)];\n      meshStates[0].id = `${mapCode}-states`;\n    }\n\n    if (\n      mapMeta.mapType === MAP_TYPES.STATE ||\n      (isDistrictView && mapViz === MAP_VIZS.CHOROPLETH)\n    ) {\n      // Add id to mesh\n      meshDistricts = [mesh(geoData, geoData.objects.districts)];\n      meshDistricts[0].id = `${mapCode}-districts`;\n    }\n\n    svg\n      .select('.state-borders')\n      .attr('fill', 'none')\n      .attr('stroke-width', 1.5)\n      .selectAll('path')\n      .data(meshStates, (d) => d.id)\n      .join(\n        (enter) => enter.append('path').attr('d', path).attr('stroke', '#fff0'),\n        (update) => update,\n        (exit) => exit.transition(T).attr('stroke', '#fff0').remove()\n      )\n      .transition(T)\n      .attr('stroke', strokeColor.bind(this, '40'));\n\n    svg\n      .select('.district-borders')\n      .attr('fill', 'none')\n      .attr('stroke-width', 1.5)\n      .selectAll('path')\n      .data(meshDistricts, (d) => d.id)\n      .join(\n        (enter) =>\n          enter\n            .append('path')\n            .attr('d', path)\n            .attr('d', path)\n            .attr('stroke', '#fff0'),\n        (update) => update,\n        (exit) => exit.transition(T).attr('stroke', '#fff0').remove()\n      )\n      .transition(T)\n      .attr('stroke', strokeColor.bind(this, '40'));\n  }, [\n    geoData,\n    mapMeta,\n    mapCode,\n    mapViz,\n    isDistrictView,\n    statistic,\n    path,\n    strokeColor,\n  ]);\n\n  // Highlight\n  useEffect(() => {\n    const stateCode = regionHighlighted.stateCode;\n    const stateName = STATE_NAMES[stateCode];\n    const district = regionHighlighted.districtName;\n\n    const svg = select(svgRef.current);\n\n    if (mapViz === MAP_VIZS.BUBBLE) {\n      svg\n        .select('.circles')\n        .selectAll('circle')\n        .attr('fill-opacity', (d) => {\n          const highlighted =\n            stateName === d.properties.st_nm &&\n            ((!district && stateCode !== mapCode) ||\n              district === d.properties?.district ||\n              !isDistrictView ||\n              (district === UNKNOWN_DISTRICT_KEY && !d.properties.district));\n          return highlighted ? 1 : 0.25;\n        });\n    } else if (mapViz === MAP_VIZS.SPIKE) {\n      svg\n        .select('.spikes')\n        .selectAll('path')\n        .attr('fill-opacity', (d) => {\n          const highlighted =\n            stateName === d.properties.st_nm &&\n            ((!district && stateCode !== mapCode) ||\n              district === d.properties?.district ||\n              !isDistrictView ||\n              (district === UNKNOWN_DISTRICT_KEY && !d.properties.district));\n          return highlighted ? 1 : 0.25;\n        });\n    } else {\n      svg\n        .select('.regions')\n        .selectAll('path')\n        .each(function (d) {\n          const highlighted =\n            stateName === d.properties.st_nm &&\n            ((!district && stateCode !== mapCode) ||\n              district === d.properties?.district ||\n              !isDistrictView);\n          if (highlighted) this.parentNode.appendChild(this);\n          select(this).attr('stroke-opacity', highlighted ? 1 : 0);\n        });\n    }\n  }, [\n    geoData,\n    data,\n    mapCode,\n    isDistrictView,\n    mapViz,\n    regionHighlighted.stateCode,\n    regionHighlighted.districtName,\n    statistic,\n  ]);\n\n  return (\n    <>\n      <div className=\"svg-parent\">\n        <svg\n          id=\"chart\"\n          className={classnames({\n            zone: !!statisticConfig?.mapConfig?.colorScale,\n          })}\n          viewBox={`0 0 ${MAP_DIMENSIONS[0]} ${MAP_DIMENSIONS[1]}`}\n          preserveAspectRatio=\"xMidYMid meet\"\n          ref={svgRef}\n        >\n          <g className=\"regions\" />\n          <g className=\"state-borders\" />\n          <g className=\"district-borders\" />\n          <g className=\"circles\" />\n          <g className=\"spikes\" />\n        </svg>\n        {noDistrictData && statisticConfig?.hasPrimary && (\n          <div className={classnames('disclaimer', `is-${statistic}`)}>\n            <AlertIcon />\n            <span>\n              {t('District-wise data not available in state bulletin')}\n            </span>\n          </div>\n        )}\n      </div>\n\n      {mapScale && <MapLegend {...{data, statistic, mapViz, mapScale}} />}\n\n      <svg style={{position: 'absolute', height: 0}}>\n        <defs>\n          <filter id=\"balance-color\" colorInterpolationFilters=\"sRGB\">\n            <feColorMatrix\n              type=\"matrix\"\n              values=\"0.91372549  0           0            0  0.08627451\n                      0           0.91372549  0            0  0.08627451\n                      0           0           0.854901961  0  0.145098039\n                      0           0           0            1  0\"\n            />\n          </filter>\n        </defs>\n      </svg>\n    </>\n  );\n}\n\nexport default MapVisualizer;\n"]}}