{"ast":null,"code":"var _jsxFileName = \"/Users/nawaf/code/Create-a-D3-Dashboard-With-React-/d3ia/src/components/Timeline.js\",\n    _s = $RefreshSig$();\n\nimport { formatDate, getIndiaDateISO, getIndiaDateYesterdayISO, retry } from '../utils/commonFunctions';\nimport { CalendarIcon } from '@primer/octicons-react';\nimport classnames from 'classnames';\nimport equal from 'fast-deep-equal';\nimport { useKeenSlider } from 'keen-slider/react';\nimport 'keen-slider/keen-slider.min.css';\nimport { memo, useEffect, useMemo, useRef, useState, lazy, Suspense } from 'react';\nimport ReactDOM from 'react-dom';\nimport { FastForward, Play, Pause } from 'react-feather';\nimport { useTranslation } from 'react-i18next';\nimport { useTransition, animated } from 'react-spring';\nimport { useClickAway, useKeyPressEvent } from 'react-use';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst Calendar = /*#__PURE__*/lazy(_c = () => retry(() => import('./Calendar')));\n_c2 = Calendar;\nconst wheelSize = 18;\nconst slidesPerView = 1;\nconst slideDegree = 360 / wheelSize;\nconst distanceThreshold = 5;\nconst autoPlayDelay = 2500;\n\nfunction Timeline({\n  date,\n  setDate,\n  dates,\n  isTimelineMode,\n  setIsTimelineMode\n}) {\n  _s();\n\n  const {\n    t\n  } = useTranslation();\n  const [sliderState, setSliderState] = useState(null);\n  const [play, setPlay] = useState(false);\n  const [showCalendar, setShowCalendar] = useState(false);\n  const timelineRef = useRef();\n  const timer = useRef();\n  useClickAway(timelineRef, () => {\n    setShowCalendar(false);\n  });\n  const [sliderRef, slider] = useKeenSlider({\n    initial: date === '' ? Math.max(0, dates.length - 2) : dates.indexOf(date),\n    dragSpeed: (val, instance) => {\n      const width = instance.details().widthOrHeight;\n      return val * (width / (width / 2 * Math.tan(slideDegree * (Math.PI / 180))) / slidesPerView);\n    },\n    move: s => {\n      setSliderState(s.details());\n    },\n    afterChange: s => {\n      const slide = s.details().absoluteSlide;\n\n      if (slide === s.details().size - 1) {\n        ReactDOM.unstable_batchedUpdates(() => {\n          setIsTimelineMode(false);\n          setShowCalendar(false);\n          setDate('');\n        });\n      } else {\n        setDate(dates[slide]);\n      }\n    },\n    mode: 'free-snap',\n    slides: dates.length,\n    slidesPerView\n  });\n  const [radius, setRadius] = useState(0);\n  useEffect(() => {\n    if (slider) setRadius(slider.details().widthOrHeight);\n  }, [slider]);\n\n  const formatSlideDate = date => {\n    if (date === getIndiaDateISO()) return t('Today');else if (date === getIndiaDateYesterdayISO()) return t('Yesterday');\n    return formatDate(date, 'dd MMM y');\n  };\n\n  const slideValues = useMemo(() => {\n    if (!sliderState) return [];\n    const values = [];\n\n    for (let i = 0; i < sliderState.size; i++) {\n      const distance = sliderState.positions[i].distance * slidesPerView;\n      const rotate = Math.abs(distance) > wheelSize / 2 ? 180 : distance * (360 / wheelSize);\n      const style = {\n        transform: `rotateY(${rotate}deg) translateZ(${radius}px)`,\n        WebkitTransform: `rotateY(${rotate}deg) translateZ(${radius}px)`\n      };\n      const className = i === sliderState.absoluteSlide ? 'current' : '';\n      const slide = sliderState.absoluteSlide + Math.round(distance);\n      if (Math.abs(distance) < distanceThreshold) values.push({\n        className,\n        style,\n        slide\n      });\n    }\n\n    return values;\n  }, [sliderState, radius]);\n  useKeyPressEvent('ArrowLeft', () => {\n    if (slider) slider.prev();\n  });\n  useKeyPressEvent('ArrowRight', () => {\n    if (slider) slider.next();\n  });\n  useKeyPressEvent('Escape', () => {\n    setPlay(false);\n    if (slider) slider.moveToSlide(sliderState.size - 1);\n  });\n  useKeyPressEvent('Enter', () => {\n    setPlay(!play);\n  });\n\n  const handleClick = index => {\n    if (index === (sliderState === null || sliderState === void 0 ? void 0 : sliderState.absoluteSlide)) {\n      setShowCalendar(!showCalendar);\n    } else if (slider) {\n      slider.moveToSlide(index);\n    }\n  };\n\n  const timeline = {\n    '2020-03-25': t('Beginning of Lockdown Phase 1'),\n    '2020-04-14': t('End of Lockdown Phase 1'),\n    '2020-04-15': t('Beginning of Lockdown Phase 2'),\n    '2020-05-03': t('End of Lockdown Phase 2'),\n    '2020-05-04': t('Beginning of Lockdown Phase 3'),\n    '2020-05-17': t('End of Lockdown Phase 3'),\n    '2020-05-18': t('Beginning of Lockdown Phase 4'),\n    '2020-05-31': t('End of Lockdown Phase 4'),\n    '2020-06-01': t('Beginning of Lockdown Phase 5'),\n    '2020-11-20': 'ðŸ¥€'\n  };\n  useEffect(() => {\n    timer.current = setInterval(() => {\n      if (play && slider) {\n        slider.next();\n      }\n    }, autoPlayDelay);\n    return () => {\n      clearInterval(timer.current);\n    };\n  }, [play, slider]);\n\n  const handleWheel = event => {\n    if (slider) {\n      if (event.deltaX > 0) {\n        slider.next();\n      } else if (event.deltaX < 0) {\n        slider.prev();\n      }\n    }\n  };\n\n  const transitions = useTransition(showCalendar, {\n    from: {\n      pointerEvents: 'none',\n      paddingTop: 0,\n      marginBottom: 0,\n      height: 0,\n      opacity: 0\n    },\n    enter: {\n      pointerEvents: 'all',\n      paddingTop: 36,\n      marginBottom: 400,\n      opacity: 1\n    },\n    leave: {\n      pointerEvents: 'none',\n      paddingTop: 0,\n      marginBottom: 0,\n      height: 0,\n      opacity: 0\n    },\n    config: {\n      mass: 1,\n      tension: 100,\n      friction: 15\n    }\n  });\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: 'Timeline',\n    ref: timelineRef,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"actions timeline fadeInUp\",\n      onWheel: handleWheel,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: 'wheel-buttons',\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: 'wheel-button left',\n          onClick: handleClick.bind(this, 0),\n          children: /*#__PURE__*/_jsxDEV(FastForward, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 206,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 202,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: classnames('wheel-button', {\n            active: play\n          }),\n          onClick: setPlay.bind(this, !play),\n          children: play ? /*#__PURE__*/_jsxDEV(Pause, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 33\n          }, this) : /*#__PURE__*/_jsxDEV(Play, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 212,\n            columnNumber: 45\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 208,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"wheel-button\",\n          onClick: handleClick.bind(this, dates.length - 1),\n          children: /*#__PURE__*/_jsxDEV(FastForward, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 218,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 214,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: 'wheel',\n        ref: sliderRef,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"wheel__inner\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"wheel__slides\",\n            children: slideValues.map(({\n              className,\n              style,\n              slide\n            }) => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: `wheel__slide`,\n              style: style,\n              children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                className,\n                onClick: handleClick.bind(this, slide),\n                children: formatSlideDate(dates[slide])\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 226,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: classnames('calendar-icon', {\n                  show: slide === (sliderState === null || sliderState === void 0 ? void 0 : sliderState.absoluteSlide)\n                }),\n                onClick: setShowCalendar.bind(this, !showCalendar),\n                children: slide !== sliderState.size - 1 && /*#__PURE__*/_jsxDEV(CalendarIcon, {\n                  size: 12\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 236,\n                  columnNumber: 45\n                }, this)\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 229,\n                columnNumber: 37\n              }, this)]\n            }, slide, true, {\n              fileName: _jsxFileName,\n              lineNumber: 225,\n              columnNumber: 33\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 223,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 222,\n          columnNumber: 21\n        }, this), slideValues.map(({\n          slide\n        }) => Object.keys(timeline).includes(dates[slide]) && /*#__PURE__*/_jsxDEV(\"h5\", {\n          className: classnames('highlight', {\n            current: slide === (sliderState === null || sliderState === void 0 ? void 0 : sliderState.absoluteSlide)\n          }),\n          children: timeline[dates[slide]]\n        }, slide, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 33\n        }, this))]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Suspense, {\n      fallback: /*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 258,\n        columnNumber: 33\n      }, this),\n      children: transitions((style, item) => item && /*#__PURE__*/_jsxDEV(animated.div, {\n        style,\n        children: /*#__PURE__*/_jsxDEV(Calendar, {\n          date,\n          dates,\n          slider\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 263,\n          columnNumber: 33\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 262,\n        columnNumber: 29\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 258,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 199,\n    columnNumber: 9\n  }, this);\n}\n\n_s(Timeline, \"daIEcht8iaEA927Z7ovDrnKEMps=\", false, function () {\n  return [useTranslation, useClickAway, useKeenSlider, useKeyPressEvent, useKeyPressEvent, useKeyPressEvent, useKeyPressEvent, useTransition];\n});\n\n_c3 = Timeline;\n\nconst isEqual = (prevProps, currProps) => {\n  if (!equal(currProps.date, prevProps.date)) {\n    return false;\n  } else if (!equal(currProps.isTimelineMode, prevProps.isTimelineMode)) {\n    return false;\n  } else if (!equal(currProps.dates, prevProps.dates)) {\n    return false;\n  }\n\n  return true;\n};\n\nexport default _c4 = /*#__PURE__*/memo(Timeline, isEqual);\n\nvar _c, _c2, _c3, _c4;\n\n$RefreshReg$(_c, \"Calendar$lazy\");\n$RefreshReg$(_c2, \"Calendar\");\n$RefreshReg$(_c3, \"Timeline\");\n$RefreshReg$(_c4, \"%default%\");","map":{"version":3,"sources":["/Users/nawaf/code/Create-a-D3-Dashboard-With-React-/d3ia/src/components/Timeline.js"],"names":["formatDate","getIndiaDateISO","getIndiaDateYesterdayISO","retry","CalendarIcon","classnames","equal","useKeenSlider","memo","useEffect","useMemo","useRef","useState","lazy","Suspense","ReactDOM","FastForward","Play","Pause","useTranslation","useTransition","animated","useClickAway","useKeyPressEvent","Calendar","wheelSize","slidesPerView","slideDegree","distanceThreshold","autoPlayDelay","Timeline","date","setDate","dates","isTimelineMode","setIsTimelineMode","t","sliderState","setSliderState","play","setPlay","showCalendar","setShowCalendar","timelineRef","timer","sliderRef","slider","initial","Math","max","length","indexOf","dragSpeed","val","instance","width","details","widthOrHeight","tan","PI","move","s","afterChange","slide","absoluteSlide","size","unstable_batchedUpdates","mode","slides","radius","setRadius","formatSlideDate","slideValues","values","i","distance","positions","rotate","abs","style","transform","WebkitTransform","className","round","push","prev","next","moveToSlide","handleClick","index","timeline","current","setInterval","clearInterval","handleWheel","event","deltaX","transitions","from","pointerEvents","paddingTop","marginBottom","height","opacity","enter","leave","config","mass","tension","friction","bind","active","map","show","Object","keys","includes","item","isEqual","prevProps","currProps"],"mappings":"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","sourcesContent":["import {\n    formatDate,\n    getIndiaDateISO,\n    getIndiaDateYesterdayISO,\n    retry,\n} from '../utils/commonFunctions';\n\nimport {CalendarIcon} from '@primer/octicons-react';\nimport classnames from 'classnames';\nimport equal from 'fast-deep-equal';\nimport {useKeenSlider} from 'keen-slider/react';\nimport 'keen-slider/keen-slider.min.css';\nimport {\n    memo,\n    useEffect,\n    useMemo,\n    useRef,\n    useState,\n    lazy,\n    Suspense,\n} from 'react';\nimport ReactDOM from 'react-dom';\nimport {FastForward, Play, Pause} from 'react-feather';\nimport {useTranslation} from 'react-i18next';\nimport {useTransition, animated} from 'react-spring';\nimport {useClickAway, useKeyPressEvent} from 'react-use';\n\nconst Calendar = lazy(() => retry(() => import('./Calendar')));\n\nconst wheelSize = 18;\nconst slidesPerView = 1;\nconst slideDegree = 360 / wheelSize;\nconst distanceThreshold = 5;\nconst autoPlayDelay = 2500;\n\nfunction Timeline({date, setDate, dates, isTimelineMode, setIsTimelineMode}) {\n    const {t} = useTranslation();\n\n    const [sliderState, setSliderState] = useState(null);\n    const [play, setPlay] = useState(false);\n    const [showCalendar, setShowCalendar] = useState(false);\n    const timelineRef = useRef();\n    const timer = useRef();\n\n    useClickAway(timelineRef, () => {\n        setShowCalendar(false);\n    });\n\n    const [sliderRef, slider] = useKeenSlider({\n        initial: date === '' ? Math.max(0, dates.length - 2) : dates.indexOf(date),\n        dragSpeed: (val, instance) => {\n            const width = instance.details().widthOrHeight;\n            return (\n                val *\n                (width /\n                    ((width / 2) * Math.tan(slideDegree * (Math.PI / 180))) /\n                    slidesPerView)\n            );\n        },\n        move: (s) => {\n            setSliderState(s.details());\n        },\n        afterChange: (s) => {\n            const slide = s.details().absoluteSlide;\n            if (slide === s.details().size - 1) {\n                ReactDOM.unstable_batchedUpdates(() => {\n                    setIsTimelineMode(false);\n                    setShowCalendar(false);\n                    setDate('');\n                });\n            } else {\n                setDate(dates[slide]);\n            }\n        },\n        mode: 'free-snap',\n        slides: dates.length,\n        slidesPerView,\n    });\n\n    const [radius, setRadius] = useState(0);\n\n    useEffect(() => {\n        if (slider) setRadius(slider.details().widthOrHeight);\n    }, [slider]);\n\n    const formatSlideDate = (date) => {\n        if (date === getIndiaDateISO()) return t('Today');\n        else if (date === getIndiaDateYesterdayISO()) return t('Yesterday');\n        return formatDate(date, 'dd MMM y');\n    };\n\n    const slideValues = useMemo(() => {\n        if (!sliderState) return [];\n        const values = [];\n        for (let i = 0; i < sliderState.size; i++) {\n            const distance = sliderState.positions[i].distance * slidesPerView;\n            const rotate =\n                Math.abs(distance) > wheelSize / 2 ? 180 : distance * (360 / wheelSize);\n            const style = {\n                transform: `rotateY(${rotate}deg) translateZ(${radius}px)`,\n                WebkitTransform: `rotateY(${rotate}deg) translateZ(${radius}px)`,\n            };\n            const className = i === sliderState.absoluteSlide ? 'current' : '';\n            const slide = sliderState.absoluteSlide + Math.round(distance);\n            if (Math.abs(distance) < distanceThreshold)\n                values.push({className, style, slide});\n        }\n        return values;\n    }, [sliderState, radius]);\n\n    useKeyPressEvent('ArrowLeft', () => {\n        if (slider) slider.prev();\n    });\n\n    useKeyPressEvent('ArrowRight', () => {\n        if (slider) slider.next();\n    });\n\n    useKeyPressEvent('Escape', () => {\n        setPlay(false);\n        if (slider) slider.moveToSlide(sliderState.size - 1);\n    });\n\n    useKeyPressEvent('Enter', () => {\n        setPlay(!play);\n    });\n\n    const handleClick = (index) => {\n        if (index === sliderState?.absoluteSlide) {\n            setShowCalendar(!showCalendar);\n        } else if (slider) {\n            slider.moveToSlide(index);\n        }\n    };\n\n    const timeline = {\n        '2020-03-25': t('Beginning of Lockdown Phase 1'),\n        '2020-04-14': t('End of Lockdown Phase 1'),\n        '2020-04-15': t('Beginning of Lockdown Phase 2'),\n        '2020-05-03': t('End of Lockdown Phase 2'),\n        '2020-05-04': t('Beginning of Lockdown Phase 3'),\n        '2020-05-17': t('End of Lockdown Phase 3'),\n        '2020-05-18': t('Beginning of Lockdown Phase 4'),\n        '2020-05-31': t('End of Lockdown Phase 4'),\n        '2020-06-01': t('Beginning of Lockdown Phase 5'),\n        '2020-11-20': 'ðŸ¥€',\n    };\n\n    useEffect(() => {\n        timer.current = setInterval(() => {\n            if (play && slider) {\n                slider.next();\n            }\n        }, autoPlayDelay);\n        return () => {\n            clearInterval(timer.current);\n        };\n    }, [play, slider]);\n\n    const handleWheel = (event) => {\n        if (slider) {\n            if (event.deltaX > 0) {\n                slider.next();\n            } else if (event.deltaX < 0) {\n                slider.prev();\n            }\n        }\n    };\n\n    const transitions = useTransition(showCalendar, {\n        from: {\n            pointerEvents: 'none',\n            paddingTop: 0,\n            marginBottom: 0,\n            height: 0,\n            opacity: 0,\n        },\n        enter: {\n            pointerEvents: 'all',\n            paddingTop: 36,\n            marginBottom: 400,\n            opacity: 1,\n        },\n        leave: {\n            pointerEvents: 'none',\n            paddingTop: 0,\n            marginBottom: 0,\n            height: 0,\n            opacity: 0,\n        },\n        config: {\n            mass: 1,\n            tension: 100,\n            friction: 15,\n        },\n    });\n\n    return (\n        <div className={'Timeline'} ref={timelineRef}>\n            <div className=\"actions timeline fadeInUp\" onWheel={handleWheel}>\n                <div className={'wheel-buttons'}>\n                    <div\n                        className={'wheel-button left'}\n                        onClick={handleClick.bind(this, 0)}\n                    >\n                        <FastForward />\n                    </div>\n                    <div\n                        className={classnames('wheel-button', {active: play})}\n                        onClick={setPlay.bind(this, !play)}\n                    >\n                        {play ? <Pause /> : <Play />}\n                    </div>\n                    <div\n                        className=\"wheel-button\"\n                        onClick={handleClick.bind(this, dates.length - 1)}\n                    >\n                        <FastForward />\n                    </div>\n                </div>\n                <div className={'wheel'} ref={sliderRef}>\n                    <div className=\"wheel__inner\">\n                        <div className=\"wheel__slides\">\n                            {slideValues.map(({className, style, slide}) => (\n                                <div className={`wheel__slide`} style={style} key={slide}>\n                                    <h5 {...{className}} onClick={handleClick.bind(this, slide)}>\n                                        {formatSlideDate(dates[slide])}\n                                    </h5>\n                                    <div\n                                        className={classnames('calendar-icon', {\n                                            show: slide === sliderState?.absoluteSlide,\n                                        })}\n                                        onClick={setShowCalendar.bind(this, !showCalendar)}\n                                    >\n                                        {slide !== sliderState.size - 1 && (\n                                            <CalendarIcon size={12} />\n                                        )}\n                                    </div>\n                                </div>\n                            ))}\n                        </div>\n                    </div>\n                    {slideValues.map(\n                        ({slide}) =>\n                            Object.keys(timeline).includes(dates[slide]) && (\n                                <h5\n                                    className={classnames('highlight', {\n                                        current: slide === sliderState?.absoluteSlide,\n                                    })}\n                                    key={slide}\n                                >\n                                    {timeline[dates[slide]]}\n                                </h5>\n                            )\n                    )}\n                </div>\n            </div>\n            <Suspense fallback={<div />}>\n                {transitions(\n                    (style, item) =>\n                        item && (\n                            <animated.div {...{style}}>\n                                <Calendar {...{date, dates, slider}} />\n                            </animated.div>\n                        )\n                )}\n            </Suspense>\n        </div>\n    );\n}\n\nconst isEqual = (prevProps, currProps) => {\n    if (!equal(currProps.date, prevProps.date)) {\n        return false;\n    } else if (!equal(currProps.isTimelineMode, prevProps.isTimelineMode)) {\n        return false;\n    } else if (!equal(currProps.dates, prevProps.dates)) {\n        return false;\n    }\n    return true;\n};\n\nexport default memo(Timeline, isEqual);\n"]},"metadata":{},"sourceType":"module"}